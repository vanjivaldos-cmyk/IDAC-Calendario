<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calend√°rio IDAC 2026</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            padding: 20px;
            color: #fff;
        }
        .header {
            text-align: center;
            margin-bottom: 20px;
        }
        .header-logo {
            width: 100px;
            height: auto;
            margin-bottom: 10px;
            filter: drop-shadow(0 4px 15px rgba(255, 215, 0, 0.4));
        }
        .header h1 {
            font-size: 2.2rem;
            color: #ffd700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin-bottom: 5px;
        }
        .header h2 {
            font-size: 1.1rem;
            color: #a0a0a0;
            font-weight: normal;
        }
        .sync-status {
            text-align: center;
            margin-bottom: 10px;
            font-size: 0.8rem;
        }
        .sync-status.online { color: #22c55e; }
        .sync-status.offline { color: #ef4444; }
        .toolbar {
            max-width: 1600px;
            margin: 0 auto 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }
        .toolbar button {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: bold;
            transition: all 0.2s;
        }
        .btn-add {
            background: #22c55e;
            color: white;
        }
        .btn-add:hover {
            background: #16a34a;
        }
        .btn-export {
            background: #3b82f6;
            color: white;
        }
        .btn-export:hover {
            background: #2563eb;
        }
        .btn-clear {
            background: #ef4444;
            color: white;
        }
        .btn-clear:hover {
            background: #dc2626;
        }
        .calendar-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
            max-width: 1600px;
            margin: 0 auto;
        }
        .month-card {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
        }
        .month-header {
            text-align: center;
            font-size: 1.3rem;
            font-weight: bold;
            color: #ffd700;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(255,215,0,0.3);
        }
        .month-footer {
            margin-top: 10px;
            padding-top: 8px;
            border-top: 1px solid rgba(255,255,255,0.1);
            font-size: 0.7rem;
            color: #a0a0a0;
        }
        .month-footer .feriado-item {
            display: flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 3px;
        }
        .month-footer .feriado-dia {
            background: #dc2626;
            color: white;
            padding: 1px 5px;
            border-radius: 3px;
            font-weight: bold;
            min-width: 20px;
            text-align: center;
        }
        
        /* Feriados inline - s√≥ aparece na impress√£o */
        .feriados-inline {
            display: none;
        }
        .weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            text-align: center;
            font-size: 0.75rem;
            color: #888;
            margin-bottom: 5px;
        }
        .weekdays span {
            padding: 5px 0;
        }
        .days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
        }
        .day {
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding: 3px;
            border-radius: 8px;
            font-size: 0.85rem;
            position: relative;
            min-height: 45px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .day:not(.empty):hover {
            background: rgba(255,255,255,0.15);
            transform: scale(1.05);
        }
        .day.empty {
            background: transparent;
            cursor: default;
        }
        .day.sunday {
            color: #ff6b6b;
        }
        .day.has-event {
            background: rgba(255,215,0,0.15);
            border: 1px solid rgba(255,215,0,0.3);
        }
        .day.has-event:hover {
            background: rgba(255,215,0,0.25);
        }
        .day.filtered-out {
            opacity: 0.3;
        }
        .day.filtered-match {
            background: rgba(34,197,94,0.3) !important;
            border: 2px solid #22c55e !important;
        }
        .day .day-number {
            font-weight: bold;
            margin-bottom: 2px;
        }
        .day .event-dots {
            display: flex;
            gap: 2px;
            flex-wrap: wrap;
            justify-content: center;
        }
        .event-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
        }
        .event-dot.lideranca { background: #ff6b6b; }
        .event-dot.tarde-deus { background: #4ecdc4; }
        .event-dot.curso { background: #a855f7; }
        .event-dot.candeias { background: #f97316; }
        .event-dot.mulheres { background: #ec4899; }
        .event-dot.especial { background: #ffd700; }
        .event-dot.ebf { background: #22c55e; }
        .event-dot.homens { background: #3b82f6; }
        .event-dot.outro { background: #6b7280; }
        .event-dot.feriado { background: #dc2626; }
        .event-dot.copa { background: #15803d; }
        .event-dot.eleicao { background: #7c3aed; }
        .event-dot.teens { background: #f59e0b; }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        .modal-overlay.active {
            display: flex;
        }
        .modal {
            background: #1a1a2e;
            border-radius: 15px;
            padding: 25px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            border: 2px solid #ffd700;
        }
        .modal h3 {
            color: #ffd700;
            margin-bottom: 20px;
            text-align: center;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #a0a0a0;
            font-size: 0.9rem;
        }
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.2);
            background: rgba(255,255,255,0.1);
            color: #fff;
            font-size: 0.95rem;
        }
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #ffd700;
        }
        .form-group select option {
            background: #1a1a2e;
            color: #fff;
        }
        .modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        .modal-buttons button {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: bold;
            transition: all 0.2s;
        }
        .btn-save {
            background: #22c55e;
            color: white;
        }
        .btn-save:hover {
            background: #16a34a;
        }
        .btn-cancel {
            background: #6b7280;
            color: white;
        }
        .btn-cancel:hover {
            background: #4b5563;
        }
        .btn-delete {
            background: #ef4444;
            color: white;
        }
        .btn-delete:hover {
            background: #dc2626;
        }

        /* Lista de eventos no modal */
        .events-in-day {
            margin-bottom: 20px;
        }
        .event-card {
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 10px;
            border-left: 4px solid #ffd700;
        }
        .event-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        .event-card-title {
            color: #ffd700;
            font-weight: bold;
        }
        .event-card-actions {
            display: flex;
            gap: 5px;
        }
        .event-card-actions button {
            padding: 5px 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.75rem;
        }
        .btn-edit-small {
            background: #3b82f6;
            color: white;
        }
        .btn-delete-small {
            background: #ef4444;
            color: white;
        }
        .event-card-details {
            font-size: 0.85rem;
            color: #a0a0a0;
        }

        .legend {
            max-width: 1600px;
            margin: 30px auto 0;
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
        }
        .legend h3 {
            color: #ffd700;
            margin-bottom: 15px;
            text-align: center;
        }
        .legend-items {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
        }
        .legend-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .events-list {
            max-width: 1600px;
            margin: 30px auto 0;
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
        }
        .events-list h3 {
            color: #ffd700;
            margin-bottom: 15px;
            text-align: center;
        }
        
        /* Cards de eventos por m√™s */
        .events-by-month {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 15px;
        }
        .month-events-card {
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .month-events-header {
            background: linear-gradient(135deg, rgba(255,215,0,0.3), rgba(255,215,0,0.1));
            padding: 10px 15px;
            font-weight: bold;
            color: #ffd700;
            font-size: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .month-events-header .event-count {
            background: #ffd700;
            color: #1a1a2e;
            padding: 2px 10px;
            border-radius: 10px;
            font-size: 0.75rem;
        }
        .month-events-body {
            padding: 10px;
        }
        .month-event-item {
            display: flex;
            padding: 8px;
            border-bottom: 1px solid rgba(255,255,255,0.05);
            font-size: 0.85rem;
            align-items: center;
            gap: 10px;
        }
        .month-event-item:last-child {
            border-bottom: none;
        }
        .month-event-item:hover {
            background: rgba(255,255,255,0.05);
        }
        .event-day {
            background: rgba(255,215,0,0.2);
            color: #ffd700;
            padding: 3px 8px;
            border-radius: 5px;
            font-weight: bold;
            min-width: 30px;
            text-align: center;
        }
        .event-info {
            flex: 1;
        }
        .event-info .event-title {
            color: #fff;
            font-weight: 500;
        }
        .event-info .event-details {
            color: #a0a0a0;
            font-size: 0.75rem;
            margin-top: 2px;
        }
        .event-actions-mini {
            display: flex;
            gap: 3px;
        }
        .event-actions-mini button {
            padding: 3px 6px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.7rem;
        }
        
        /* Filtros com Checkboxes - Dropdown Style */
        .filters-container {
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
        }
        .filters-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        .filters-header h4 {
            color: #ffd700;
            font-size: 1rem;
        }
        .filter-section {
            margin-bottom: 10px;
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            overflow: hidden;
        }
        .filter-section-title {
            color: #4ecdc4;
            font-size: 0.9rem;
            padding: 12px 15px;
            background: rgba(255,255,255,0.05);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.2s;
        }
        .filter-section-title:hover {
            background: rgba(255,255,255,0.1);
        }
        .filter-section-title .arrow {
            transition: transform 0.3s;
        }
        .filter-section-title.open .arrow {
            transform: rotate(180deg);
        }
        .filter-section-title .selected-count {
            background: #ffd700;
            color: #1a1a2e;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.75rem;
            margin-left: 10px;
        }
        .filter-options {
            display: none;
            flex-wrap: wrap;
            gap: 8px;
            padding: 15px;
            background: rgba(0,0,0,0.2);
        }
        .filter-options.open {
            display: flex;
        }
        .filter-checkbox {
            display: flex;
            align-items: center;
            gap: 5px;
            background: rgba(255,255,255,0.1);
            padding: 5px 10px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.8rem;
        }
        .filter-checkbox:hover {
            background: rgba(255,255,255,0.2);
        }
        .filter-checkbox input {
            cursor: pointer;
        }
        .filter-checkbox.checked {
            background: rgba(255,215,0,0.3);
            border: 1px solid #ffd700;
        }
        
        .events-table {
            width: 100%;
            border-collapse: collapse;
        }
        .events-table th,
        .events-table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .events-table th {
            color: #ffd700;
            font-weight: bold;
        }
        .events-table tr:hover {
            background: rgba(255,255,255,0.05);
        }
        .events-table .actions button {
            padding: 5px 10px;
            margin-right: 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.75rem;
        }

        /* Toast notification */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #22c55e;
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            display: none;
            z-index: 2000;
            animation: slideIn 0.3s ease;
        }
        .toast.error {
            background: #ef4444;
        }
        .toast.active {
            display: block;
        }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .instructions {
            max-width: 1600px;
            margin: 0 auto 20px;
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            font-size: 0.9rem;
            color: #a0a0a0;
        }
        .instructions strong {
            color: #ffd700;
        }

        /* ==================== ESTILOS DE IMPRESS√ÉO / PDF ==================== */
        @media print {
            @page {
                size: A4 landscape;
                margin: 5mm;
            }
            
            body {
                background: white !important;
                color: black !important;
                padding: 0 !important;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            
            .header {
                margin-bottom: 5px !important;
                padding: 0 !important;
            }
            
            .header h1 {
                color: #1a1a2e !important;
                text-shadow: none !important;
                font-size: 1.2rem !important;
                margin-bottom: 2px !important;
            }
            
            .header h2 {
                color: #666 !important;
                font-size: 0.7rem !important;
            }
            
            .header-logo {
                width: 50px !important;
                height: 50px !important;
                margin-bottom: 5px !important;
            }
            
            /* Esconder elementos n√£o necess√°rios na impress√£o */
            .toolbar, .sync-status, .instructions, .legend, 
            .events-list, .modal-overlay, .toast {
                display: none !important;
            }
            
            .calendar-container {
                display: grid !important;
                grid-template-columns: repeat(3, 1fr) !important;
                gap: 4px !important;
                max-width: 100% !important;
            }
            
            .month-card {
                background: white !important;
                border: 1px solid #999 !important;
                border-radius: 3px !important;
                padding: 4px !important;
                page-break-inside: avoid !important;
                break-inside: avoid !important;
            }
            
            .month-header {
                color: #1a1a2e !important;
                font-size: 0.75rem !important;
                font-weight: bold !important;
                border-bottom: 1px solid #999 !important;
                padding-bottom: 2px !important;
                margin-bottom: 2px !important;
            }
            
            .weekdays {
                font-size: 0.5rem !important;
                color: #666 !important;
            }
            
            .weekdays span {
                padding: 1px 0 !important;
            }
            
            .days {
                gap: 1px !important;
            }
            
            .day {
                font-size: 0.55rem !important;
                min-height: 16px !important;
                aspect-ratio: auto !important;
                padding: 1px !important;
                border: 1px solid #ddd !important;
            }
            
            .day .day-number {
                font-size: 0.55rem !important;
            }
            
            .day.sunday {
                color: #dc2626 !important;
            }
            
            .day.has-event {
                background: #fff8dc !important;
                border-color: #daa520 !important;
            }
            
            .event-dot {
                width: 3px !important;
                height: 3px !important;
            }
            
            .event-dots {
                gap: 1px !important;
            }
            
            .event-dot.lideranca { background: #ff6b6b !important; }
            .event-dot.tarde-deus { background: #4ecdc4 !important; }
            .event-dot.curso { background: #a855f7 !important; }
            .event-dot.candeias { background: #f97316 !important; }
            .event-dot.mulheres { background: #ec4899 !important; }
            .event-dot.especial { background: #ffd700 !important; }
            .event-dot.ebf { background: #22c55e !important; }
            .event-dot.homens { background: #3b82f6 !important; }
            .event-dot.outro { background: #6b7280 !important; }
            .event-dot.feriado { background: #dc2626 !important; }
            .event-dot.copa { background: #15803d !important; }
            .event-dot.eleicao { background: #7c3aed !important; }
            .event-dot.teens { background: #f59e0b !important; }
            
            .month-footer {
                display: none !important;
            }
            
            /* Feriados inline nos espa√ßos vazios */
            .month-card .feriados-inline {
                display: block !important;
                font-size: 0.45rem !important;
                color: #666 !important;
                margin-top: 2px !important;
                line-height: 1.2 !important;
            }
            
            .feriados-inline .feriado-tag {
                display: inline-block !important;
                background: #fee2e2 !important;
                color: #dc2626 !important;
                padding: 0 2px !important;
                border-radius: 2px !important;
                margin: 1px !important;
                font-weight: bold !important;
            }
        }
        
        /* Vers√£o s√≥ calend√°rio para impress√£o */
        body.print-calendar-only .events-list,
        body.print-calendar-only .legend {
            display: none !important;
        }
        
        /* Vers√£o s√≥ lista para impress√£o */
        body.print-list-only .calendar-container,
        body.print-list-only .legend {
            display: none !important;
        }
        
        /* Impress√£o do Calend√°rio - A4 Paisagem */
        @media print {
            body.print-calendar-only {
                background: white !important;
            }
        }
        
        @page {
            size: A4 landscape;
            margin: 10mm;
        }
        
        /* Impress√£o da Lista - A4 Retrato */
        body.print-list-only {
            background: white !important;
        }
        
        body.print-list-only .calendar-container {
            display: none !important;
            visibility: hidden !important;
            height: 0 !important;
            overflow: hidden !important;
        }
        
        body.print-list-only .legend {
            display: none !important;
            visibility: hidden !important;
        }
        
        body.print-list-only .events-list {
            display: block !important;
            visibility: visible !important;
        }
        
        @media print {
            body.print-list-only .events-list {
                display: block !important;
                visibility: visible !important;
                background: white !important;
                padding: 0 !important;
            }
            
            body.print-list-only .calendar-container {
                display: none !important;
                visibility: hidden !important;
                height: 0 !important;
                max-height: 0 !important;
                overflow: hidden !important;
            }
            
            body.print-list-only .legend {
                display: none !important;
                visibility: hidden !important;
            }
            
            body.print-list-only .events-list h3 {
                color: #1a1a2e !important;
                font-size: 1.2rem !important;
                margin-bottom: 15px !important;
            }
            
            body.print-list-only .filters-container {
                display: none !important;
            }
            
            body.print-list-only .events-by-month {
                display: grid !important;
                grid-template-columns: repeat(2, 1fr) !important;
                gap: 10px !important;
            }
            
            body.print-list-only .month-events-card {
                border: 1px solid #ccc !important;
                page-break-inside: avoid !important;
                break-inside: avoid !important;
            }
            
            body.print-list-only .month-events-header {
                background: #1a1a2e !important;
                color: white !important;
                padding: 5px 10px !important;
                font-size: 0.8rem !important;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            
            body.print-list-only .month-events-header .event-count {
                background: #ffd700 !important;
                color: #1a1a2e !important;
            }
            
            body.print-list-only .month-events-body {
                padding: 5px !important;
            }
            
            body.print-list-only .month-event-item {
                padding: 3px 5px !important;
                font-size: 0.65rem !important;
                border-bottom: 1px solid #eee !important;
            }
            
            body.print-list-only .event-day {
                background: #f0f0f0 !important;
                color: #333 !important;
                padding: 2px 5px !important;
                font-size: 0.6rem !important;
            }
            
            body.print-list-only .event-info .event-title {
                color: #333 !important;
                font-size: 0.65rem !important;
            }
            
            body.print-list-only .event-info .event-details {
                font-size: 0.55rem !important;
                color: #666 !important;
            }
            
            body.print-list-only .event-actions-mini {
                display: none !important;
            }
            
            body.print-list-only .header h1 {
                font-size: 1.3rem !important;
            }
            
            body.print-list-only .header h2 {
                font-size: 0.85rem !important;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <img src="https://raw.githubusercontent.com/vanjivaldos-cmyk/games-idac/main/images/LogoGame.png" alt="Logo IDAC" class="header-logo" onerror="this.style.display='none'">
        <h1>üìÖ Calend√°rio IDAC 2026</h1>
        <h2>Igreja de Deus √Åguas Claras - Programa√ß√£o Anual</h2>
    </div>

    <div class="sync-status" id="syncStatus">üîÑ Conectando...</div>

    <div class="instructions" id="instructions">
        <strong>üí° Dica:</strong> Clique em qualquer dia para visualizar os eventos detalhados.
    </div>

    <div class="toolbar">
        <button class="btn-add admin-only" onclick="openAddModal()" style="display:none">‚ûï Novo Evento</button>
        <button class="btn-add admin-only" onclick="openImportModal()" style="display:none; background: #f59e0b;">üìù Importar Lote</button>
        <button class="btn-export" onclick="exportEvents()">üì§ Exportar JSON</button>
        <button style="padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-size: 0.9rem; font-weight: bold; background: #8b5cf6; color: white;" onclick="printCalendar()">üñ®Ô∏è Imprimir Calend√°rio</button>
        <button style="padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-size: 0.9rem; font-weight: bold; background: #06b6d4; color: white;" onclick="window.open('Lista_Eventos_IDAC.html', '_blank')">üìã Ver Lista de Eventos</button>
        <button class="btn-clear admin-only" onclick="clearAllEvents()" style="display:none">üóëÔ∏è Limpar Tudo</button>
        <button id="adminBtn" onclick="logoutAdmin()" style="padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-size: 0.9rem; font-weight: bold; background: #6b7280; color: white;">üîê Admin</button>
    </div>

    <div class="calendar-container" id="calendar"></div>

    <div class="legend">
        <h3>Legenda</h3>
        <div class="legend-items">
            <div class="legend-item"><div class="legend-dot" style="background:#ff6b6b"></div>Reuni√£o Lideran√ßa</div>
            <div class="legend-item"><div class="legend-dot" style="background:#4ecdc4"></div>"Noite" com Deus</div>
            <div class="legend-item"><div class="legend-dot" style="background:#a855f7"></div>Curso</div>
            <div class="legend-item"><div class="legend-dot" style="background:#f97316"></div>Culto Candeias</div>
            <div class="legend-item"><div class="legend-dot" style="background:#ec4899"></div>Min. Mulheres</div>
            <div class="legend-item"><div class="legend-dot" style="background:#3b82f6"></div>Min. Homens</div>
            <div class="legend-item"><div class="legend-dot" style="background:#22c55e"></div>EBF</div>
            <div class="legend-item"><div class="legend-dot" style="background:#ffd700"></div>Eventos Especiais</div>
            <div class="legend-item"><div class="legend-dot" style="background:#6b7280"></div>Outros</div>
            <div class="legend-item"><div class="legend-dot" style="background:#dc2626"></div>Feriado Nacional</div>
            <div class="legend-item"><div class="legend-dot" style="background:#15803d"></div>Copa do Mundo</div>
            <div class="legend-item"><div class="legend-dot" style="background:#7c3aed"></div>Elei√ß√µes</div>
            <div class="legend-item"><div class="legend-dot" style="background:#f59e0b"></div>Min. Teens</div>
        </div>
    </div>

    <div class="events-list">
        <h3>üìã Lista Completa de Eventos</h3>
        <div class="filters-container">
            <div class="filters-header">
                <h4>üîç Filtros</h4>
                <button onclick="clearFilters()" style="padding: 5px 15px; border: none; border-radius: 5px; background: #6b7280; color: white; cursor: pointer; font-size: 0.8rem;">üîÑ Limpar Filtros</button>
            </div>
            
            <div class="filter-section">
                <div class="filter-section-title" onclick="toggleFilterSection('months', this)">
                    <span>üìÖ M√™s <span class="selected-count" id="countMonths" style="display:none">0</span></span>
                    <span class="arrow">‚ñº</span>
                </div>
                <div class="filter-options" id="filterMonths"></div>
            </div>
            
            <div class="filter-section">
                <div class="filter-section-title" onclick="toggleFilterSection('types', this)">
                    <span>üéØ Tipo de Evento <span class="selected-count" id="countTypes" style="display:none">0</span></span>
                    <span class="arrow">‚ñº</span>
                </div>
                <div class="filter-options" id="filterTypes"></div>
            </div>
            
            <div class="filter-section">
                <div class="filter-section-title" onclick="toggleFilterSection('resps', this)">
                    <span>üë§ Respons√°vel <span class="selected-count" id="countResps" style="display:none">0</span></span>
                    <span class="arrow">‚ñº</span>
                </div>
                <div class="filter-options" id="filterResps"></div>
            </div>
        </div>
        <div id="eventsTableContainer"></div>
    </div>

    <!-- Modal para dia -->
    <div class="modal-overlay" id="dayModal">
        <div class="modal">
            <h3 id="modalTitle">Eventos do Dia</h3>
            <div class="events-in-day" id="eventsInDay"></div>
            <hr style="border-color: rgba(255,255,255,0.1); margin: 15px 0;">
            <h4 style="color: #4ecdc4; margin-bottom: 15px;">Adicionar Novo Evento</h4>
            <div class="form-group">
                <label>T√≠tulo do Evento *</label>
                <input type="text" id="eventTitle" placeholder="Ex: Culto das Mulheres">
            </div>
            <div class="form-group">
                <label>Hor√°rio</label>
                <input type="text" id="eventTime" placeholder="Ex: 20h ou 8h √†s 18h">
            </div>
            <div class="form-group">
                <label>Respons√°vel</label>
                <input type="text" id="eventResp" placeholder="Ex: Pr¬™ Maria Pereira">
            </div>
            <div class="form-group">
                <label>Categoria</label>
                <select id="eventType">
                    <option value="especial">Evento Especial</option>
                    <option value="lideranca">Reuni√£o Lideran√ßa</option>
                    <option value="tarde-deus">"Noite" com Deus</option>
                    <option value="curso">Curso</option>
                    <option value="candeias">Culto Candeias</option>
                    <option value="mulheres">Min. Mulheres</option>
                    <option value="homens">Min. Homens</option>
                    <option value="ebf">EBF</option>
                    <option value="feriado">Feriado Nacional</option>
                    <option value="copa">Copa do Mundo</option>
                    <option value="eleicao">Elei√ß√µes</option>
                    <option value="outro">Outro</option>
                </select>
            </div>
            <div class="form-group">
                <label>Observa√ß√µes</label>
                <textarea id="eventNotes" rows="2" placeholder="Observa√ß√µes adicionais..."></textarea>
            </div>
            <div class="modal-buttons">
                <button class="btn-cancel" onclick="closeModal()">Cancelar</button>
                <button class="btn-save" onclick="saveEvent()">Salvar Evento</button>
            </div>
        </div>
    </div>

    <!-- Modal para adicionar evento com sele√ß√£o de data -->
    <div class="modal-overlay" id="addModal">
        <div class="modal">
            <h3>Adicionar Novo Evento</h3>
            <div class="form-group">
                <label>Data *</label>
                <input type="date" id="newEventDate" min="2026-01-01" max="2026-12-31">
            </div>
            <div class="form-group">
                <label>T√≠tulo do Evento *</label>
                <input type="text" id="newEventTitle" placeholder="Ex: Culto das Mulheres">
            </div>
            <div class="form-group">
                <label>Hor√°rio</label>
                <input type="text" id="newEventTime" placeholder="Ex: 20h ou 8h √†s 18h">
            </div>
            <div class="form-group">
                <label>Respons√°vel</label>
                <input type="text" id="newEventResp" placeholder="Ex: Pr¬™ Maria Pereira">
            </div>
            <div class="form-group">
                <label>Categoria</label>
                <select id="newEventType">
                    <option value="especial">Evento Especial</option>
                    <option value="lideranca">Reuni√£o Lideran√ßa</option>
                    <option value="tarde-deus">"Noite" com Deus</option>
                    <option value="curso">Curso</option>
                    <option value="candeias">Culto Candeias</option>
                    <option value="mulheres">Min. Mulheres</option>
                    <option value="homens">Min. Homens</option>
                    <option value="ebf">EBF</option>
                    <option value="feriado">Feriado Nacional</option>
                    <option value="copa">Copa do Mundo</option>
                    <option value="eleicao">Elei√ß√µes</option>
                    <option value="outro">Outro</option>
                </select>
            </div>
            <div class="form-group">
                <label>Observa√ß√µes</label>
                <textarea id="newEventNotes" rows="2" placeholder="Observa√ß√µes adicionais..."></textarea>
            </div>
            <div class="modal-buttons">
                <button class="btn-cancel" onclick="closeAddModal()">Cancelar</button>
                <button class="btn-save" onclick="saveNewEvent()">Salvar Evento</button>
            </div>
        </div>
    </div>

    <!-- Modal para editar evento -->
    <div class="modal-overlay" id="editModal">
        <div class="modal">
            <h3>Editar Evento</h3>
            <div class="form-group">
                <label>Data *</label>
                <input type="date" id="editEventDate" min="2026-01-01" max="2026-12-31">
            </div>
            <div class="form-group">
                <label>T√≠tulo do Evento *</label>
                <input type="text" id="editEventTitle">
            </div>
            <div class="form-group">
                <label>Hor√°rio</label>
                <input type="text" id="editEventTime">
            </div>
            <div class="form-group">
                <label>Respons√°vel</label>
                <input type="text" id="editEventResp">
            </div>
            <div class="form-group">
                <label>Categoria</label>
                <select id="editEventType">
                    <option value="especial">Evento Especial</option>
                    <option value="lideranca">Reuni√£o Lideran√ßa</option>
                    <option value="tarde-deus">"Noite" com Deus</option>
                    <option value="curso">Curso</option>
                    <option value="candeias">Culto Candeias</option>
                    <option value="mulheres">Min. Mulheres</option>
                    <option value="homens">Min. Homens</option>
                    <option value="ebf">EBF</option>
                    <option value="feriado">Feriado Nacional</option>
                    <option value="copa">Copa do Mundo</option>
                    <option value="eleicao">Elei√ß√µes</option>
                    <option value="outro">Outro</option>
                </select>
            </div>
            <div class="form-group">
                <label>Observa√ß√µes</label>
                <textarea id="editEventNotes" rows="2"></textarea>
            </div>
            <div class="modal-buttons">
                <button class="btn-delete" onclick="deleteEditingEvent()">Excluir</button>
                <button class="btn-cancel" onclick="closeEditModal()">Cancelar</button>
                <button class="btn-save" onclick="updateEvent()">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Modal para importar eventos em lote -->
    <div class="modal-overlay" id="importModal">
        <div class="modal" style="max-width: 700px;">
            <h3>üìù Importar Eventos em Lote</h3>
            <p style="color: #a0a0a0; font-size: 0.85rem; margin-bottom: 15px;">
                Cole a lista de eventos no formato abaixo. Um evento por linha.<br>
                <strong style="color: #ffd700;">Formato:</strong> DATA | HOR√ÅRIO | T√çTULO | RESPONS√ÅVEL | CATEGORIA | OBSERVA√á√ïES
            </p>
            <div style="background: rgba(0,0,0,0.3); padding: 10px; border-radius: 8px; margin-bottom: 15px; font-size: 0.8rem; color: #4ecdc4;">
                <strong>Exemplo:</strong><br>
                17/01/2026 | 18h | Encontro Online | Min. Teens | teens |<br>
                16/02/2026 | | Acampadentro | Min. Teens | teens | Dia 1<br>
                01/05/2026 | 9h √†s 18h | Acampamento | Min. Teens | teens | Dia 1
            </div>
            <div style="background: rgba(0,0,0,0.3); padding: 10px; border-radius: 8px; margin-bottom: 15px; font-size: 0.75rem; color: #a0a0a0;">
                <strong style="color: #ffd700;">Categorias v√°lidas:</strong> lideranca, tarde-deus, curso, candeias, mulheres, homens, ebf, especial, feriado, copa, eleicao, teens, outro
            </div>
            <div class="form-group">
                <label>Cole os eventos aqui:</label>
                <textarea id="importText" rows="10" placeholder="17/01/2026 | 18h | Encontro Online | Min. Teens | teens |
31/01/2026 | 19h | Candeias Teens | Min. Teens | teens |
16/02/2026 | | Acampadentro | Min. Teens | teens | Dia 1" style="font-family: monospace; font-size: 0.85rem;"></textarea>
            </div>
            <div id="importPreview" style="margin-bottom: 15px;"></div>
            <div class="modal-buttons">
                <button class="btn-cancel" onclick="closeImportModal()">Cancelar</button>
                <button style="flex:1; padding: 12px; border: none; border-radius: 8px; cursor: pointer; font-size: 0.95rem; font-weight: bold; background: #3b82f6; color: white;" onclick="previewImport()">üëÅÔ∏è Visualizar</button>
                <button class="btn-save" onclick="executeImport()">‚úÖ Importar</button>
            </div>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <script>
        // ==================== CONFIGURA√á√ÉO ADMIN ====================
        const SENHA_ADMIN = 'idac2026';
        let isAdmin = false;

        function checkAdmin() {
            const senha = prompt('Digite a senha de administrador:');
            if (senha === SENHA_ADMIN) {
                isAdmin = true;
                document.getElementById('adminBtn').innerHTML = 'üîì Admin (Logado)';
                document.getElementById('adminBtn').style.background = '#22c55e';
                document.querySelectorAll('.admin-only').forEach(el => el.style.display = '');
                document.getElementById('instructions').innerHTML = '<strong>üí° Admin:</strong> Clique em qualquer dia para adicionar ou editar eventos. Os dados s√£o salvos na nuvem automaticamente!';
                showToast('Acesso de administrador liberado!');
                updateEventsTable();
            } else if (senha !== null) {
                showToast('Senha incorreta!', true);
            }
        }

        function logoutAdmin() {
            if (isAdmin) {
                isAdmin = false;
                document.getElementById('adminBtn').innerHTML = 'üîê Admin';
                document.getElementById('adminBtn').style.background = '#6b7280';
                document.querySelectorAll('.admin-only').forEach(el => el.style.display = 'none');
                document.getElementById('instructions').innerHTML = '<strong>üí° Dica:</strong> Clique em qualquer dia para visualizar os eventos detalhados.';
                showToast('Voc√™ saiu do modo administrador');
                updateEventsTable();
            } else {
                checkAdmin();
            }
        }

        // ==================== CONFIGURA√á√ÉO FIREBASE ====================
        const firebaseConfig = {
            apiKey: "AIzaSyD_FbMpEZYn_lLZiSjGmP0sMM7XcuTn8Qw",
            authDomain: "games-idac.firebaseapp.com",
            databaseURL: "https://games-idac-default-rtdb.firebaseio.com",
            projectId: "games-idac",
            storageBucket: "games-idac.appspot.com",
            messagingSenderId: "123456789",
            appId: "1:123456789:web:abc123"
        };
        
        // Inicializar Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const calendarioRef = database.ref('calendario_2026');

        // ==================== VARI√ÅVEIS GLOBAIS ====================
        const monthNames = ['Janeiro', 'Fevereiro', 'Mar√ßo', 'Abril', 'Maio', 'Junho', 
                          'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'];
        const weekDays = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'S√°b'];

        let events = {};
        let currentDate = null;
        let editingEvent = null;
        let editingDate = null;
        
        // Filtros selecionados
        let selectedMonths = [];
        let selectedTypes = [];
        let selectedResps = [];

        // ==================== FIREBASE LISTENERS ====================
        function setupFirebaseListeners() {
            calendarioRef.on('value', (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    events = data;
                } else {
                    // Se n√£o houver dados, inicializar com eventos padr√£o
                    initializeDefaultEvents();
                }
                createCalendar();
                buildFilterOptions();
                updateEventsTable();
                updateSyncStatus(true);
            }, (error) => {
                console.error('Erro Firebase:', error);
                updateSyncStatus(false);
                // Fallback para localStorage
                loadFromLocalStorage();
            });
        }

        function updateSyncStatus(online) {
            const status = document.getElementById('syncStatus');
            if (online) {
                status.className = 'sync-status online';
                status.innerHTML = '‚òÅÔ∏è Sincronizado com a nuvem';
            } else {
                status.className = 'sync-status offline';
                status.innerHTML = '‚ö†Ô∏è Modo offline - dados locais';
            }
        }

        function saveToFirebase() {
            calendarioRef.set(events)
                .then(() => {
                    console.log('Dados salvos no Firebase');
                })
                .catch((error) => {
                    console.error('Erro ao salvar:', error);
                    // Fallback para localStorage
                    localStorage.setItem('idac_calendar_2026_firebase', JSON.stringify(events));
                });
        }

        function loadFromLocalStorage() {
            const saved = localStorage.getItem('idac_calendar_2026_firebase');
            if (saved) {
                events = JSON.parse(saved);
            } else {
                initializeDefaultEvents();
            }
            createCalendar();
            buildFilterOptions();
            updateEventsTable();
        }

        // ==================== INICIALIZA√á√ÉO DE EVENTOS PADR√ÉO ====================
        function initializeDefaultEvents() {
            events = {
                '2026-01-24': [{id: generateId(), title: 'Reuni√£o Lideran√ßa', time: '8h √†s 18h', resp: '', type: 'lideranca', notes: ''}],
            };

            // Culto Mulheres (3¬™ quinta-feira) - exceto dezembro
            const cultoMulheres = [
                '2026-02-19', '2026-03-19', '2026-04-16', '2026-05-21', '2026-06-18',
                '2026-07-16', '2026-08-20', '2026-09-17', '2026-10-15', '2026-11-19'
            ];
            cultoMulheres.forEach(date => {
                if (!events[date]) events[date] = [];
                events[date].push({id: generateId(), title: 'Culto Mulheres', time: '20h', resp: 'Min. Mulher', type: 'mulheres', notes: 'Nos lares/Templo'});
            });

            // Eventos especiais
            addDefaultEvent('2026-05-10', 'Caf√© Dia das M√£es', '', 'Minist√©rio a definir', 'especial', '');
            addDefaultEvent('2026-06-26', 'A√ß√£o Estacionamento', '', 'Min. Homens', 'homens', '');
            addDefaultEvent('2026-06-26', 'Bazar', '', 'Min. Mulheres', 'mulheres', '');
            addDefaultEvent('2026-06-27', 'A√ß√£o Estacionamento', '', 'Min. Homens', 'homens', '');
            addDefaultEvent('2026-06-27', 'Bazar', '', 'Min. Mulheres', 'mulheres', '');
            addDefaultEvent('2026-07-10', 'EBF (proposta)', 'Manh√£/Tarde', 'Min. KIDS', 'ebf', 'Dia 1');
            addDefaultEvent('2026-07-11', 'EBF (proposta)', 'Manh√£/Tarde', 'Min. KIDS', 'ebf', 'Dia 2');
            addDefaultEvent('2026-07-12', 'EBF (proposta)', 'Manh√£/Tarde', 'Min. KIDS', 'ebf', 'Dia 3');
            addDefaultEvent('2026-08-09', 'Caf√© Dia dos Pais', '', 'Minist√©rio a definir', 'especial', '');
            addDefaultEvent('2026-08-28', 'Anivers√°rio 11 anos IDAC', '20h', 'Toda Igreja', 'especial', 'Com Batismo nas √°guas - Sexta-feira');
            addDefaultEvent('2026-08-29', 'Anivers√°rio 11 anos IDAC', 'Manh√£/Tarde/Noite', 'Toda Igreja', 'especial', 'Com Batismo nas √°guas - S√°bado');
            addDefaultEvent('2026-08-30', 'Anivers√°rio 11 anos IDAC', '9h30 e 18h', 'Toda Igreja', 'especial', 'Com Batismo nas √°guas - Domingo');
            addDefaultEvent('2026-10-17', 'Dia das Crian√ßas (proposta)', 'Manh√£/Tarde', 'Min. KIDS', 'especial', '');
            addDefaultEvent('2026-11-06', 'Vig√≠lia no Templo', '22h √†s 0h', 'Min. Mulheres', 'mulheres', '');
            addDefaultEvent('2026-11-29', 'Confraterniza√ß√£o Min. Mulheres', '', 'Min. Mulheres', 'mulheres', '');
            addDefaultEvent('2026-12-20', 'Cantata de Natal (proposta)', '', 'Louvor e Artes', 'especial', '');
            addDefaultEvent('2026-12-31', 'Culto e Jantar da Virada (proposta)', '', '', 'especial', '');

            // ========== MINIST√âRIO TEENS ==========
            // Janeiro
            addDefaultEvent('2026-01-17', 'Encontro Online Teens', '18h', 'Min. Teens', 'teens', '');
            addDefaultEvent('2026-01-31', 'Candeias Teens', '19h', 'Min. Teens', 'teens', '');
            // Fevereiro
            addDefaultEvent('2026-02-14', 'Candeias Teens', '19h', 'Min. Teens', 'teens', '');
            addDefaultEvent('2026-02-16', 'Acampadentro Teens', '', 'Min. Teens', 'teens', 'Dia 1');
            addDefaultEvent('2026-02-17', 'Acampadentro Teens', '', 'Min. Teens', 'teens', 'Dia 2');
            addDefaultEvent('2026-02-28', 'Evento Regional de Ora√ß√£o', '', 'Min. Teens', 'teens', '');
            // Mar√ßo
            addDefaultEvent('2026-03-14', 'Candeias Teens', '19h', 'Min. Teens', 'teens', '');
            addDefaultEvent('2026-03-28', 'Treinamento de Lideran√ßa Teens', '', 'Min. Teens', 'teens', '');
            // Abril
            addDefaultEvent('2026-04-11', 'Candeias Teens', '19h', 'Min. Teens', 'teens', '');
            addDefaultEvent('2026-04-25', 'Candeias Teens', '19h', 'Min. Teens', 'teens', '');
            // Maio
            addDefaultEvent('2026-05-01', 'Acampamento Teens', '', 'Min. Teens', 'teens', 'Dia 1');
            addDefaultEvent('2026-05-02', 'Acampamento Teens', '', 'Min. Teens', 'teens', 'Dia 2');
            addDefaultEvent('2026-05-03', 'Acampamento Teens', '', 'Min. Teens', 'teens', 'Dia 3');
            addDefaultEvent('2026-05-23', 'Candeias Teens', '19h', 'Min. Teens', 'teens', '');
            // Junho
            addDefaultEvent('2026-06-06', 'Candeias Teens', '19h', 'Min. Teens', 'teens', '');
            addDefaultEvent('2026-06-20', 'Candeias Teens', '19h', 'Min. Teens', 'teens', '');
            // Julho
            addDefaultEvent('2026-07-04', 'Candeias Teens', '19h', 'Min. Teens', 'teens', '');
            addDefaultEvent('2026-07-25', 'Curso de Evangelismo Teens', '9h √†s 18h', 'Min. Teens', 'teens', '');
            // Agosto
            addDefaultEvent('2026-08-07', 'Vig√≠lia Teens', '22h30', 'Min. Teens', 'teens', '');
            addDefaultEvent('2026-08-22', 'Candeias Teens', '19h', 'Min. Teens', 'teens', '');
            // Setembro
            addDefaultEvent('2026-09-04', 'Latin Fast Teens', '', 'Min. Teens', 'teens', 'Dia 1');
            addDefaultEvent('2026-09-05', 'Latin Fast Teens', '', 'Min. Teens', 'teens', 'Dia 2');
            addDefaultEvent('2026-09-06', 'Latin Fast Teens', '', 'Min. Teens', 'teens', 'Dia 3');
            addDefaultEvent('2026-09-12', 'Candeias Teens', '19h', 'Min. Teens', 'teens', '');
            addDefaultEvent('2026-09-20', 'Culto Teens', '18h', 'Min. Teens', 'teens', '');
            // Outubro
            addDefaultEvent('2026-10-02', 'Vig√≠lia Teens', '22h30', 'Min. Teens', 'teens', '');
            addDefaultEvent('2026-10-24', 'Candeias Teens', '19h', 'Min. Teens', 'teens', '');
            // Novembro
            addDefaultEvent('2026-11-07', 'Candeias Teens', '19h', 'Min. Teens', 'teens', '');
            addDefaultEvent('2026-11-20', '24 Horas Teens', '6h √†s 6h', 'Min. Teens', 'teens', 'In√≠cio');
            addDefaultEvent('2026-11-21', '24 Horas Teens', '6h √†s 6h', 'Min. Teens', 'teens', 'T√©rmino');
            // Dezembro
            addDefaultEvent('2026-12-05', 'Confraterniza√ß√£o Teens', '11h √†s 18h', 'Min. Teens', 'teens', '');

            // Feriados Nacionais
            addDefaultEvent('2026-01-01', 'Confraterniza√ß√£o Universal (Ano Novo)', '', '', 'feriado', 'Feriado Nacional');
            addDefaultEvent('2026-04-03', 'Paix√£o de Cristo (Sexta-feira Santa)', '', '', 'feriado', 'Feriado Nacional');
            addDefaultEvent('2026-04-21', 'Tiradentes', '', '', 'feriado', 'Feriado Nacional');
            addDefaultEvent('2026-05-01', 'Dia do Trabalho', '', '', 'feriado', 'Feriado Nacional');
            addDefaultEvent('2026-09-07', 'Independ√™ncia do Brasil', '', '', 'feriado', 'Feriado Nacional');
            addDefaultEvent('2026-10-12', 'Nossa Senhora Aparecida', '', '', 'feriado', 'Feriado Nacional');
            addDefaultEvent('2026-11-02', 'Finados', '', '', 'feriado', 'Feriado Nacional');
            addDefaultEvent('2026-11-15', 'Proclama√ß√£o da Rep√∫blica', '', '', 'feriado', 'Feriado Nacional');
            addDefaultEvent('2026-11-20', 'Dia da Consci√™ncia Negra', '', '', 'feriado', 'Feriado Nacional');
            addDefaultEvent('2026-12-25', 'Natal', '', '', 'feriado', 'Feriado Nacional');
            addDefaultEvent('2026-02-16', 'Carnaval', '', '', 'feriado', 'Ponto Facultativo');
            addDefaultEvent('2026-02-17', 'Carnaval', '', '', 'feriado', 'Ponto Facultativo');
            addDefaultEvent('2026-02-18', 'Quarta-feira de Cinzas', 'at√© 14h', '', 'feriado', 'Ponto Facultativo');
            addDefaultEvent('2026-06-04', 'Corpus Christi', '', '', 'feriado', 'Ponto Facultativo');

            // Copa do Mundo
            addDefaultEvent('2026-06-11', 'COPA: Abertura - M√©xico x √Åfrica do Sul', '16h', '', 'copa', 'Est√°dio Azteca, Cidade do M√©xico');
            addDefaultEvent('2026-06-13', 'COPA: Brasil x Marrocos', '19h', '', 'copa', 'MetLife Stadium, Nova Jersey - 1¬™ rodada');
            addDefaultEvent('2026-06-19', 'COPA: Brasil x Haiti', '22h', '', 'copa', 'Lincoln Financial Field, Filad√©lfia - 2¬™ rodada');
            addDefaultEvent('2026-06-24', 'COPA: Esc√≥cia x Brasil', '19h', '', 'copa', 'Hard Rock Stadium, Miami - 3¬™ rodada');
            addDefaultEvent('2026-06-29', 'COPA: Poss√≠vel jogo Brasil (32-avos)', 'A definir', '', 'copa', 'Houston ou Monterrey (se classificado)');
            addDefaultEvent('2026-07-18', 'COPA: Disputa 3¬∫ lugar', '16h', '', 'copa', 'Hard Rock Stadium, Miami');
            addDefaultEvent('2026-07-19', 'COPA: FINAL', '16h', '', 'copa', 'MetLife Stadium, Nova Jersey');

            // Elei√ß√µes
            addDefaultEvent('2026-10-04', 'ELEI√á√ïES - 1¬∫ Turno', '8h √†s 17h', '', 'eleicao', 'Presidente, Governadores, Senadores, Deputados');
            addDefaultEvent('2026-11-01', 'ELEI√á√ïES - 2¬∫ Turno (se houver)', '8h √†s 17h', '', 'eleicao', 'Presidente e Governadores');

            // Semana de Ora√ß√£o - exceto dezembro
            const ultimasQuartas = [
                '2026-03-25', '2026-04-29', '2026-05-27', '2026-06-24', '2026-07-29',
                '2026-08-26', '2026-09-30', '2026-10-28', '2026-11-25'
            ];
            const ultimasQuintas = [
                '2026-03-26', '2026-04-30', '2026-05-28', '2026-06-25', '2026-07-30',
                '2026-08-27', '2026-09-24', '2026-10-29', '2026-11-26'
            ];

            // Curso "De dentro para fora"
            const cursoQuartas = [
                '2026-01-28', '2026-02-04', '2026-02-11', '2026-02-18',
                '2026-02-25', '2026-03-04', '2026-03-11', '2026-03-18'
            ];
            
            // "Noite" com Deus - todas as quartas
            let date = new Date(2026, 0, 28);
            while (date.getFullYear() === 2026) {
                if (date.getDay() === 3) {
                    const key = formatDateKey(date);
                    if (!events[key]) events[key] = [];
                    if (ultimasQuartas.includes(key)) {
                        events[key].push({id: generateId(), title: 'Semana de Ora√ß√£o', time: '20h', resp: 'Min. Intercess√£o', type: 'especial', notes: ''});
                    } else if (!cursoQuartas.includes(key)) {
                        events[key].push({id: generateId(), title: '"Noite" com Deus', time: '20h', resp: 'Pr¬™ Maria Pereira', type: 'tarde-deus', notes: ''});
                    }
                }
                date.setDate(date.getDate() + 1);
            }

            // Curso
            cursoQuartas.forEach((dateStr, index) => {
                if (!events[dateStr]) events[dateStr] = [];
                events[dateStr].push({id: generateId(), title: 'Curso "De dentro para fora"', time: '20h', resp: 'Pr¬™ Maria/Pr¬™ Nelcy', type: 'curso', notes: `Encontro ${index + 1}/8`});
            });

            // Semana de Ora√ß√£o quintas
            ultimasQuintas.forEach(dateStr => {
                if (!events[dateStr]) events[dateStr] = [];
                events[dateStr].push({id: generateId(), title: 'Semana de Ora√ß√£o', time: '20h', resp: 'Min. Intercess√£o', type: 'especial', notes: ''});
            });

            // Culto Candeias
            const cultoCandeias = [
                '2026-02-05', '2026-03-05', '2026-04-02', '2026-05-07', '2026-06-04',
                '2026-07-02', '2026-08-06', '2026-09-03', '2026-10-01', '2026-11-05', '2026-12-03'
            ];
            cultoCandeias.forEach(dateStr => {
                if (!events[dateStr]) events[dateStr] = [];
                events[dateStr].push({id: generateId(), title: 'Culto Candeias', time: '20h', resp: 'Pb. Jos√© Dias e Di√°c. Lidiane', type: 'candeias', notes: 'Nos lares'});
            });

            saveToFirebase();
        }

        function addDefaultEvent(date, title, time, resp, type, notes) {
            if (!events[date]) events[date] = [];
            events[date].push({id: generateId(), title, time, resp, type, notes});
        }

        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }

        function formatDateKey(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        function formatDateBR(dateStr) {
            const [year, month, day] = dateStr.split('-');
            return `${day}/${month}/${year}`;
        }

        // ==================== CALEND√ÅRIO ====================
        function createCalendar() {
            const container = document.getElementById('calendar');
            container.innerHTML = '';
            
            for (let month = 0; month < 12; month++) {
                const monthCard = document.createElement('div');
                monthCard.className = 'month-card';
                
                const monthHeader = document.createElement('div');
                monthHeader.className = 'month-header';
                monthHeader.textContent = monthNames[month];
                monthCard.appendChild(monthHeader);
                
                const weekdaysDiv = document.createElement('div');
                weekdaysDiv.className = 'weekdays';
                weekDays.forEach(day => {
                    const span = document.createElement('span');
                    span.textContent = day;
                    weekdaysDiv.appendChild(span);
                });
                monthCard.appendChild(weekdaysDiv);
                
                const daysDiv = document.createElement('div');
                daysDiv.className = 'days';
                
                const firstDay = new Date(2026, month, 1);
                const lastDay = new Date(2026, month + 1, 0);
                const startDay = firstDay.getDay();
                
                // Coletar feriados do m√™s
                const feriadosDoMes = [];
                
                for (let i = 0; i < startDay; i++) {
                    const emptyDay = document.createElement('div');
                    emptyDay.className = 'day empty';
                    daysDiv.appendChild(emptyDay);
                }
                
                for (let day = 1; day <= lastDay.getDate(); day++) {
                    const dayDiv = document.createElement('div');
                    const currentDate = new Date(2026, month, day);
                    const dateKey = formatDateKey(currentDate);
                    const dayEvents = events[dateKey] || [];
                    
                    dayDiv.className = 'day';
                    if (currentDate.getDay() === 0) dayDiv.classList.add('sunday');
                    if (dayEvents.length > 0) dayDiv.classList.add('has-event');
                    
                    dayDiv.onclick = () => openDayModal(dateKey);
                    
                    const dayNumber = document.createElement('span');
                    dayNumber.className = 'day-number';
                    dayNumber.textContent = day;
                    dayDiv.appendChild(dayNumber);
                    
                    if (dayEvents.length > 0) {
                        const dotsDiv = document.createElement('div');
                        dotsDiv.className = 'event-dots';
                        
                        const uniqueTypes = [...new Set(dayEvents.map(e => e.type))];
                        uniqueTypes.slice(0, 4).forEach(type => {
                            const dot = document.createElement('span');
                            dot.className = `event-dot ${type}`;
                            dotsDiv.appendChild(dot);
                        });
                        dayDiv.appendChild(dotsDiv);
                        
                        // Verificar se tem feriado neste dia
                        dayEvents.forEach(event => {
                            if (event.type === 'feriado') {
                                // Abreviar nome do feriado
                                let nomeAbrev = event.title
                                    .replace('Confraterniza√ß√£o Universal (Ano Novo)', 'Ano Novo')
                                    .replace('Paix√£o de Cristo (Sexta-feira Santa)', 'Sexta Santa')
                                    .replace('Nossa Senhora Aparecida', 'N.S. Aparecida')
                                    .replace('Proclama√ß√£o da Rep√∫blica', 'Proc. Rep√∫blica')
                                    .replace('Dia da Consci√™ncia Negra', 'Consc. Negra')
                                    .replace('Quarta-feira de Cinzas', 'Cinzas')
                                    .replace('Corpus Christi', 'Corpus Christi')
                                    .replace('Dia do Trabalho', 'Trabalho')
                                    .replace('Independ√™ncia do Brasil', 'Independ√™ncia');
                                feriadosDoMes.push({
                                    dia: day,
                                    nome: nomeAbrev
                                });
                            }
                        });
                    }
                    
                    daysDiv.appendChild(dayDiv);
                }
                
                monthCard.appendChild(daysDiv);
                
                // Adicionar rodap√© com feriados (para visualiza√ß√£o na tela)
                if (feriadosDoMes.length > 0) {
                    const monthFooter = document.createElement('div');
                    monthFooter.className = 'month-footer';
                    monthFooter.innerHTML = feriadosDoMes.map(f => 
                        `<div class="feriado-item"><span class="feriado-dia">${f.dia}</span> ${f.nome}</div>`
                    ).join('');
                    monthCard.appendChild(monthFooter);
                    
                    // Adicionar vers√£o inline para impress√£o (mais compacta)
                    const feriadosInline = document.createElement('div');
                    feriadosInline.className = 'feriados-inline';
                    feriadosInline.innerHTML = feriadosDoMes.map(f => 
                        `<span class="feriado-tag">${f.dia} ${f.nome}</span>`
                    ).join(' ');
                    monthCard.appendChild(feriadosInline);
                }
                
                container.appendChild(monthCard);
            }
        }

        // ==================== FILTROS COM CHECKBOXES ====================
        function buildFilterOptions() {
            const allEvents = [];
            Object.keys(events).forEach(dateKey => {
                events[dateKey].forEach(event => {
                    allEvents.push({...event, date: dateKey});
                });
            });

            // Meses
            const months = [...new Set(allEvents.map(e => e.date.substring(0, 7)))].sort();
            const monthsContainer = document.getElementById('filterMonths');
            monthsContainer.innerHTML = months.map(m => {
                const [year, month] = m.split('-');
                const monthName = monthNames[parseInt(month) - 1];
                const checked = selectedMonths.includes(m) ? 'checked' : '';
                const checkedClass = selectedMonths.includes(m) ? 'checked' : '';
                return `<label class="filter-checkbox ${checkedClass}">
                    <input type="checkbox" value="${m}" ${checked} onchange="toggleFilter('month', '${m}', this)">
                    ${monthName}
                </label>`;
            }).join('');

            // Tipos
            const typeNames = {
                'lideranca': 'Reuni√£o Lideran√ßa',
                'tarde-deus': '"Noite" com Deus',
                'curso': 'Curso',
                'candeias': 'Culto Candeias',
                'mulheres': 'Min. Mulheres',
                'homens': 'Min. Homens',
                'ebf': 'EBF',
                'especial': 'Eventos Especiais',
                'feriado': 'Feriado',
                'copa': 'Copa do Mundo',
                'eleicao': 'Elei√ß√µes',
                'teens': 'Min. Teens',
                'outro': 'Outros'
            };
            const types = [...new Set(allEvents.map(e => e.type))].sort();
            const typesContainer = document.getElementById('filterTypes');
            typesContainer.innerHTML = types.map(t => {
                const checked = selectedTypes.includes(t) ? 'checked' : '';
                const checkedClass = selectedTypes.includes(t) ? 'checked' : '';
                return `<label class="filter-checkbox ${checkedClass}">
                    <input type="checkbox" value="${t}" ${checked} onchange="toggleFilter('type', '${t}', this)">
                    ${typeNames[t] || t}
                </label>`;
            }).join('');

            // Respons√°veis
            const resps = [...new Set(allEvents.map(e => e.resp).filter(r => r && r.trim()))].sort();
            const respsContainer = document.getElementById('filterResps');
            respsContainer.innerHTML = resps.map(r => {
                const checked = selectedResps.includes(r) ? 'checked' : '';
                const checkedClass = selectedResps.includes(r) ? 'checked' : '';
                return `<label class="filter-checkbox ${checkedClass}">
                    <input type="checkbox" value="${r}" ${checked} onchange="toggleFilter('resp', '${r}', this)">
                    ${r}
                </label>`;
            }).join('');
        }

        function toggleFilter(type, value, checkbox) {
            const label = checkbox.parentElement;
            if (checkbox.checked) {
                label.classList.add('checked');
                if (type === 'month' && !selectedMonths.includes(value)) selectedMonths.push(value);
                if (type === 'type' && !selectedTypes.includes(value)) selectedTypes.push(value);
                if (type === 'resp' && !selectedResps.includes(value)) selectedResps.push(value);
            } else {
                label.classList.remove('checked');
                if (type === 'month') selectedMonths = selectedMonths.filter(m => m !== value);
                if (type === 'type') selectedTypes = selectedTypes.filter(t => t !== value);
                if (type === 'resp') selectedResps = selectedResps.filter(r => r !== value);
            }
            updateEventsTable();
            updateFilterCounts();
            applyFiltersToCalendar();
        }
        
        function applyFiltersToCalendar() {
            const hasFilters = selectedMonths.length > 0 || selectedTypes.length > 0 || selectedResps.length > 0;
            
            // Percorrer todos os dias do calend√°rio
            document.querySelectorAll('.day:not(.empty)').forEach(dayEl => {
                // Remover classes anteriores
                dayEl.classList.remove('filtered-out', 'filtered-match');
                
                if (!hasFilters) return; // Se n√£o h√° filtros, n√£o faz nada
                
                // Pegar a data deste dia
                const dayNumber = dayEl.querySelector('.day-number')?.textContent;
                if (!dayNumber) return;
                
                // Encontrar o m√™s deste dia (pelo card pai)
                const monthCard = dayEl.closest('.month-card');
                if (!monthCard) return;
                
                const monthHeader = monthCard.querySelector('.month-header')?.textContent;
                const monthIndex = monthNames.indexOf(monthHeader);
                if (monthIndex === -1) return;
                
                const dateKey = `2026-${String(monthIndex + 1).padStart(2, '0')}-${String(dayNumber).padStart(2, '0')}`;
                const dayEvents = events[dateKey] || [];
                
                // Verificar se algum evento deste dia passa nos filtros
                let hasMatchingEvent = false;
                
                if (dayEvents.length > 0) {
                    hasMatchingEvent = dayEvents.some(event => {
                        let matchMonth = selectedMonths.length === 0 || selectedMonths.includes(dateKey.substring(0, 7));
                        let matchType = selectedTypes.length === 0 || selectedTypes.includes(event.type);
                        let matchResp = selectedResps.length === 0 || selectedResps.includes(event.resp);
                        return matchMonth && matchType && matchResp;
                    });
                }
                
                // Aplicar classe visual
                if (dayEvents.length > 0) {
                    if (hasMatchingEvent) {
                        dayEl.classList.add('filtered-match');
                    } else {
                        dayEl.classList.add('filtered-out');
                    }
                }
            });
        }

        function clearFilters() {
            selectedMonths = [];
            selectedTypes = [];
            selectedResps = [];
            buildFilterOptions();
            updateEventsTable();
            updateFilterCounts();
            applyFiltersToCalendar();
        }

        function toggleFilterSection(section, titleElement) {
            const optionsDiv = document.getElementById('filter' + section.charAt(0).toUpperCase() + section.slice(1));
            optionsDiv.classList.toggle('open');
            titleElement.classList.toggle('open');
        }

        function updateFilterCounts() {
            const countMonths = document.getElementById('countMonths');
            const countTypes = document.getElementById('countTypes');
            const countResps = document.getElementById('countResps');
            
            if (selectedMonths.length > 0) {
                countMonths.textContent = selectedMonths.length;
                countMonths.style.display = 'inline';
            } else {
                countMonths.style.display = 'none';
            }
            
            if (selectedTypes.length > 0) {
                countTypes.textContent = selectedTypes.length;
                countTypes.style.display = 'inline';
            } else {
                countTypes.style.display = 'none';
            }
            
            if (selectedResps.length > 0) {
                countResps.textContent = selectedResps.length;
                countResps.style.display = 'inline';
            } else {
                countResps.style.display = 'none';
            }
        }

        // ==================== LISTA DE EVENTOS POR M√äS ====================
        function updateEventsTable() {
            const container = document.getElementById('eventsTableContainer');
            
            let allEvents = [];
            Object.keys(events).sort().forEach(dateKey => {
                events[dateKey].forEach(event => {
                    allEvents.push({...event, date: dateKey});
                });
            });
            
            // Aplicar filtros
            if (selectedMonths.length > 0) {
                allEvents = allEvents.filter(e => selectedMonths.includes(e.date.substring(0, 7)));
            }
            if (selectedTypes.length > 0) {
                allEvents = allEvents.filter(e => selectedTypes.includes(e.type));
            }
            if (selectedResps.length > 0) {
                allEvents = allEvents.filter(e => selectedResps.includes(e.resp));
            }
            
            if (allEvents.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #a0a0a0;">Nenhum evento encontrado</p>';
                return;
            }
            
            // Agrupar eventos por m√™s
            const eventsByMonth = {};
            allEvents.forEach(event => {
                const monthKey = event.date.substring(0, 7);
                if (!eventsByMonth[monthKey]) {
                    eventsByMonth[monthKey] = [];
                }
                eventsByMonth[monthKey].push(event);
            });
            
            // Gerar HTML dos cards
            let html = `<p style="text-align: right; font-size: 0.8rem; color: #a0a0a0; margin-bottom: 15px;">üìä ${allEvents.length} evento(s) encontrado(s)</p>`;
            html += '<div class="events-by-month">';
            
            Object.keys(eventsByMonth).sort().forEach(monthKey => {
                const monthEvents = eventsByMonth[monthKey];
                const [year, month] = monthKey.split('-');
                const monthName = monthNames[parseInt(month) - 1];
                
                html += `
                    <div class="month-events-card">
                        <div class="month-events-header">
                            <span>üìÖ ${monthName}</span>
                            <span class="event-count">${monthEvents.length} evento(s)</span>
                        </div>
                        <div class="month-events-body">
                            ${monthEvents.map(event => {
                                const day = event.date.split('-')[2];
                                return `
                                    <div class="month-event-item">
                                        <span class="event-day">${parseInt(day)}</span>
                                        <div class="event-info">
                                            <div class="event-title">${event.title}</div>
                                            <div class="event-details">
                                                ${event.time ? '‚è∞ ' + event.time : ''}
                                                ${event.time && event.resp ? ' ‚Ä¢ ' : ''}
                                                ${event.resp ? 'üë§ ' + event.resp : ''}
                                            </div>
                                        </div>
                                        ${isAdmin ? `
                                        <div class="event-actions-mini">
                                            <button class="btn-edit-small" onclick="openEditModal('${event.date}', '${event.id}')">‚úèÔ∏è</button>
                                            <button class="btn-delete-small" onclick="deleteEventFromTable('${event.date}', '${event.id}')">üóëÔ∏è</button>
                                        </div>
                                        ` : ''}
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            container.innerHTML = html;
        }

        // ==================== MODAIS ====================
        function openDayModal(dateKey) {
            currentDate = dateKey;
            const dayEvents = events[dateKey] || [];
            
            document.getElementById('modalTitle').textContent = `üìÖ ${formatDateBR(dateKey)}`;
            
            const eventsContainer = document.getElementById('eventsInDay');
            if (dayEvents.length > 0) {
                eventsContainer.innerHTML = dayEvents.map(event => `
                    <div class="event-card">
                        <div class="event-card-header">
                            <span class="event-card-title">${event.title}</span>
                            ${isAdmin ? `
                            <div class="event-card-actions">
                                <button class="btn-edit-small" onclick="openEditModal('${dateKey}', '${event.id}')">‚úèÔ∏è Editar</button>
                                <button class="btn-delete-small" onclick="deleteEvent('${dateKey}', '${event.id}')">üóëÔ∏è</button>
                            </div>
                            ` : ''}
                        </div>
                        <div class="event-card-details">
                            ${event.time ? `‚è∞ ${event.time}` : ''}
                            ${event.resp ? `<br>üë§ ${event.resp}` : ''}
                            ${event.notes ? `<br>üìù ${event.notes}` : ''}
                        </div>
                    </div>
                `).join('');
            } else {
                eventsContainer.innerHTML = '<p style="color: #a0a0a0; text-align: center;">Nenhum evento neste dia</p>';
            }
            
            // Mostrar/esconder formul√°rio de adicionar baseado em isAdmin
            const addFormSection = document.querySelector('#dayModal hr');
            const addFormTitle = document.querySelector('#dayModal h4');
            const formGroups = document.querySelectorAll('#dayModal .form-group');
            const modalButtons = document.querySelector('#dayModal .modal-buttons');
            
            if (addFormSection) addFormSection.style.display = isAdmin ? '' : 'none';
            if (addFormTitle) addFormTitle.style.display = isAdmin ? '' : 'none';
            formGroups.forEach(fg => fg.style.display = isAdmin ? '' : 'none');
            if (modalButtons) {
                const saveBtn = modalButtons.querySelector('.btn-save');
                if (saveBtn) saveBtn.style.display = isAdmin ? '' : 'none';
            }
            
            document.getElementById('eventTitle').value = '';
            document.getElementById('eventTime').value = '';
            document.getElementById('eventResp').value = '';
            document.getElementById('eventType').value = 'especial';
            document.getElementById('eventNotes').value = '';
            
            document.getElementById('dayModal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('dayModal').classList.remove('active');
            currentDate = null;
        }

        function saveEvent() {
            if (!isAdmin) {
                showToast('Apenas administradores podem adicionar eventos', true);
                return;
            }
            const title = document.getElementById('eventTitle').value.trim();
            if (!title) {
                showToast('Digite o t√≠tulo do evento', true);
                return;
            }
            
            const newEvent = {
                id: generateId(),
                title: title,
                time: document.getElementById('eventTime').value.trim(),
                resp: document.getElementById('eventResp').value.trim(),
                type: document.getElementById('eventType').value,
                notes: document.getElementById('eventNotes').value.trim()
            };
            
            if (!events[currentDate]) events[currentDate] = [];
            events[currentDate].push(newEvent);
            
            saveToFirebase();
            createCalendar();
            buildFilterOptions();
            updateEventsTable();
            openDayModal(currentDate);
            showToast('Evento adicionado com sucesso!');
        }

        function deleteEvent(dateKey, eventId) {
            if (!isAdmin) {
                showToast('Apenas administradores podem excluir eventos', true);
                return;
            }
            if (!confirm('Deseja realmente excluir este evento?')) return;
            
            events[dateKey] = events[dateKey].filter(e => e.id !== eventId);
            if (events[dateKey].length === 0) delete events[dateKey];
            
            saveToFirebase();
            createCalendar();
            buildFilterOptions();
            updateEventsTable();
            openDayModal(dateKey);
            showToast('Evento exclu√≠do!');
        }

        function openAddModal() {
            if (!isAdmin) {
                showToast('Apenas administradores podem adicionar eventos', true);
                return;
            }
            document.getElementById('newEventDate').value = '';
            document.getElementById('newEventTitle').value = '';
            document.getElementById('newEventTime').value = '';
            document.getElementById('newEventResp').value = '';
            document.getElementById('newEventType').value = 'especial';
            document.getElementById('newEventNotes').value = '';
            document.getElementById('addModal').classList.add('active');
        }

        function closeAddModal() {
            document.getElementById('addModal').classList.remove('active');
        }

        function saveNewEvent() {
            if (!isAdmin) {
                showToast('Apenas administradores podem adicionar eventos', true);
                return;
            }
            const dateKey = document.getElementById('newEventDate').value;
            const title = document.getElementById('newEventTitle').value.trim();
            
            if (!dateKey) {
                showToast('Selecione uma data', true);
                return;
            }
            if (!title) {
                showToast('Digite o t√≠tulo do evento', true);
                return;
            }
            
            const newEvent = {
                id: generateId(),
                title: title,
                time: document.getElementById('newEventTime').value.trim(),
                resp: document.getElementById('newEventResp').value.trim(),
                type: document.getElementById('newEventType').value,
                notes: document.getElementById('newEventNotes').value.trim()
            };
            
            if (!events[dateKey]) events[dateKey] = [];
            events[dateKey].push(newEvent);
            
            saveToFirebase();
            createCalendar();
            buildFilterOptions();
            updateEventsTable();
            closeAddModal();
            showToast('Evento adicionado com sucesso!');
        }

        function openEditModal(dateKey, eventId) {
            if (!isAdmin) {
                showToast('Apenas administradores podem editar eventos', true);
                return;
            }
            editingDate = dateKey;
            const event = events[dateKey].find(e => e.id === eventId);
            editingEvent = event;
            
            document.getElementById('editEventDate').value = dateKey;
            document.getElementById('editEventTitle').value = event.title;
            document.getElementById('editEventTime').value = event.time || '';
            document.getElementById('editEventResp').value = event.resp || '';
            document.getElementById('editEventType').value = event.type || 'especial';
            document.getElementById('editEventNotes').value = event.notes || '';
            
            document.getElementById('dayModal').classList.remove('active');
            document.getElementById('editModal').classList.add('active');
        }

        function closeEditModal() {
            document.getElementById('editModal').classList.remove('active');
            editingEvent = null;
            editingDate = null;
        }

        function updateEvent() {
            if (!isAdmin) {
                showToast('Apenas administradores podem editar eventos', true);
                return;
            }
            const newDateKey = document.getElementById('editEventDate').value;
            const title = document.getElementById('editEventTitle').value.trim();
            
            if (!title) {
                showToast('Digite o t√≠tulo do evento', true);
                return;
            }
            
            events[editingDate] = events[editingDate].filter(e => e.id !== editingEvent.id);
            if (events[editingDate].length === 0) delete events[editingDate];
            
            const updatedEvent = {
                id: editingEvent.id,
                title: title,
                time: document.getElementById('editEventTime').value.trim(),
                resp: document.getElementById('editEventResp').value.trim(),
                type: document.getElementById('editEventType').value,
                notes: document.getElementById('editEventNotes').value.trim()
            };
            
            if (!events[newDateKey]) events[newDateKey] = [];
            events[newDateKey].push(updatedEvent);
            
            saveToFirebase();
            createCalendar();
            buildFilterOptions();
            updateEventsTable();
            closeEditModal();
            showToast('Evento atualizado!');
        }

        function deleteEditingEvent() {
            if (!isAdmin) {
                showToast('Apenas administradores podem excluir eventos', true);
                return;
            }
            if (!confirm('Deseja realmente excluir este evento?')) return;
            
            events[editingDate] = events[editingDate].filter(e => e.id !== editingEvent.id);
            if (events[editingDate].length === 0) delete events[editingDate];
            
            saveToFirebase();
            createCalendar();
            buildFilterOptions();
            updateEventsTable();
            closeEditModal();
            showToast('Evento exclu√≠do!');
        }

        function deleteEventFromTable(dateKey, eventId) {
            if (!isAdmin) {
                showToast('Apenas administradores podem excluir eventos', true);
                return;
            }
            if (!confirm('Deseja realmente excluir este evento?')) return;
            
            events[dateKey] = events[dateKey].filter(e => e.id !== eventId);
            if (events[dateKey].length === 0) delete events[dateKey];
            
            saveToFirebase();
            createCalendar();
            buildFilterOptions();
            updateEventsTable();
            showToast('Evento exclu√≠do!');
        }

        function exportEvents() {
            const dataStr = JSON.stringify(events, null, 2);
            const blob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'calendario_idac_2026.json';
            a.click();
            URL.revokeObjectURL(url);
            showToast('Arquivo exportado com sucesso!');
        }

        function printCalendar() {
            document.body.classList.add('print-calendar-only');
            document.body.classList.remove('print-list-only');
            
            // Adicionar estilo tempor√°rio para for√ßar A4 horizontal
            const styleSheet = document.createElement('style');
            styleSheet.id = 'print-landscape-style';
            styleSheet.textContent = '@page { size: A4 landscape; margin: 10mm; }';
            document.head.appendChild(styleSheet);
            
            showToast('Preparando impress√£o do calend√°rio (A4 Horizontal)...');
            
            setTimeout(() => {
                window.print();
                document.body.classList.remove('print-calendar-only');
                // Remover estilo tempor√°rio
                const tempStyle = document.getElementById('print-landscape-style');
                if (tempStyle) tempStyle.remove();
            }, 500);
        }

        function printList() {
            // Esconder calend√°rio e mostrar lista
            document.body.classList.add('print-list-only');
            document.body.classList.remove('print-calendar-only');
            
            // For√ßar esconder calend√°rio (para mobile)
            const calendar = document.querySelector('.calendar-container');
            const legend = document.querySelector('.legend');
            const eventsList = document.querySelector('.events-list');
            
            if (calendar) calendar.style.display = 'none';
            if (legend) legend.style.display = 'none';
            if (eventsList) eventsList.style.display = 'block';
            
            // Adicionar estilo tempor√°rio para for√ßar A4 vertical
            const styleSheet = document.createElement('style');
            styleSheet.id = 'print-portrait-style';
            styleSheet.textContent = '@page { size: A4 portrait; margin: 10mm; }';
            document.head.appendChild(styleSheet);
            
            showToast('Preparando impress√£o da lista (A4 Vertical)...');
            
            setTimeout(() => {
                window.print();
                
                // Restaurar ap√≥s impress√£o
                document.body.classList.remove('print-list-only');
                if (calendar) calendar.style.display = '';
                if (legend) legend.style.display = '';
                
                // Remover estilo tempor√°rio
                const tempStyle = document.getElementById('print-portrait-style');
                if (tempStyle) tempStyle.remove();
            }, 500);
        }

        // ==================== IMPORTA√á√ÉO EM LOTE ====================
        function openImportModal() {
            if (!isAdmin) {
                showToast('Apenas administradores podem importar eventos', true);
                return;
            }
            document.getElementById('importText').value = '';
            document.getElementById('importPreview').innerHTML = '';
            document.getElementById('importModal').classList.add('active');
        }

        function closeImportModal() {
            document.getElementById('importModal').classList.remove('active');
        }

        function parseImportLine(line) {
            const parts = line.split('|').map(p => p.trim());
            if (parts.length < 4) return null;
            
            // Parsear data (DD/MM/YYYY para YYYY-MM-DD)
            const dateStr = parts[0];
            const dateMatch = dateStr.match(/(\d{1,2})\/(\d{1,2})\/(\d{4})/);
            if (!dateMatch) return null;
            
            const day = dateMatch[1].padStart(2, '0');
            const month = dateMatch[2].padStart(2, '0');
            const year = dateMatch[3];
            const dateKey = `${year}-${month}-${day}`;
            
            return {
                date: dateKey,
                time: parts[1] || '',
                title: parts[2] || '',
                resp: parts[3] || '',
                type: parts[4] || 'especial',
                notes: parts[5] || ''
            };
        }

        function previewImport() {
            const text = document.getElementById('importText').value.trim();
            if (!text) {
                showToast('Cole os eventos primeiro', true);
                return;
            }
            
            const lines = text.split('\n').filter(l => l.trim());
            const preview = document.getElementById('importPreview');
            
            let validCount = 0;
            let invalidCount = 0;
            let html = '<div style="max-height: 200px; overflow-y: auto; background: rgba(0,0,0,0.2); padding: 10px; border-radius: 8px;">';
            html += '<table style="width: 100%; font-size: 0.75rem; border-collapse: collapse;">';
            html += '<tr style="color: #ffd700;"><th>Data</th><th>Hora</th><th>Evento</th><th>Resp.</th><th>Status</th></tr>';
            
            lines.forEach((line, index) => {
                const parsed = parseImportLine(line);
                if (parsed && parsed.title) {
                    validCount++;
                    html += `<tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
                        <td>${formatDateBR(parsed.date)}</td>
                        <td>${parsed.time || '-'}</td>
                        <td>${parsed.title}</td>
                        <td>${parsed.resp || '-'}</td>
                        <td style="color: #22c55e;">‚úÖ</td>
                    </tr>`;
                } else {
                    invalidCount++;
                    html += `<tr style="border-bottom: 1px solid rgba(255,255,255,0.1); color: #ef4444;">
                        <td colspan="4">${line.substring(0, 50)}...</td>
                        <td>‚ùå</td>
                    </tr>`;
                }
            });
            
            html += '</table></div>';
            html += `<p style="margin-top: 10px; font-size: 0.85rem;">‚úÖ <strong style="color: #22c55e;">${validCount}</strong> v√°lidos | ‚ùå <strong style="color: #ef4444;">${invalidCount}</strong> inv√°lidos</p>`;
            
            preview.innerHTML = html;
        }

        function executeImport() {
            if (!isAdmin) {
                showToast('Apenas administradores podem importar eventos', true);
                return;
            }
            
            const text = document.getElementById('importText').value.trim();
            if (!text) {
                showToast('Cole os eventos primeiro', true);
                return;
            }
            
            const lines = text.split('\n').filter(l => l.trim());
            let importedCount = 0;
            
            lines.forEach(line => {
                const parsed = parseImportLine(line);
                if (parsed && parsed.title) {
                    if (!events[parsed.date]) events[parsed.date] = [];
                    
                    // Verificar se j√° existe evento igual (evitar duplicatas)
                    const exists = events[parsed.date].some(e => 
                        e.title === parsed.title && e.time === parsed.time
                    );
                    
                    if (!exists) {
                        events[parsed.date].push({
                            id: generateId(),
                            title: parsed.title,
                            time: parsed.time,
                            resp: parsed.resp,
                            type: parsed.type,
                            notes: parsed.notes
                        });
                        importedCount++;
                    }
                }
            });
            
            if (importedCount > 0) {
                saveToFirebase();
                createCalendar();
                buildFilterOptions();
                updateEventsTable();
                closeImportModal();
                showToast(`‚úÖ ${importedCount} evento(s) importado(s) com sucesso!`);
            } else {
                showToast('Nenhum evento novo para importar', true);
            }
        }

        function clearAllEvents() {
            if (!isAdmin) {
                showToast('Apenas administradores podem limpar eventos', true);
                return;
            }
            if (!confirm('Deseja realmente APAGAR TODOS os eventos? Esta a√ß√£o n√£o pode ser desfeita.')) return;
            if (!confirm('TEM CERTEZA? Todos os eventos ser√£o perdidos!')) return;
            
            events = {};
            saveToFirebase();
            createCalendar();
            buildFilterOptions();
            updateEventsTable();
            showToast('Todos os eventos foram removidos');
        }

        function showToast(message, isError = false) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = 'toast active' + (isError ? ' error' : '');
            setTimeout(() => {
                toast.classList.remove('active');
            }, 3000);
        }

        // Fechar modais clicando fora
        document.querySelectorAll('.modal-overlay').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
        });

        // Inicializar
        setupFirebaseListeners();
    </script>
</body>
</html>
