<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inscri√ß√£o - Encontro de L√≠deres IDAC 2026</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root { --primary: #8B2F87; --secondary: #FFD700; --accent: #E8B923; --dark: #1a1a2e; --light: #f8f6f2; --success: #27ae60; --danger: #e74c3c; }
        body { font-family: 'Montserrat', sans-serif; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%); min-height: 100vh; color: var(--light); }
        body::before { content: ''; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: radial-gradient(circle at 20% 80%, rgba(139, 47, 135, 0.15) 0%, transparent 50%), radial-gradient(circle at 80% 20%, rgba(255, 215, 0, 0.1) 0%, transparent 50%); pointer-events: none; z-index: 0; }
        .container { max-width: 800px; margin: 0 auto; padding: 20px; position: relative; z-index: 1; }
        .header { text-align: center; padding: 40px 20px; margin-bottom: 30px; background: linear-gradient(180deg, rgba(139, 47, 135, 0.3) 0%, transparent 100%); border-radius: 20px; position: relative; overflow: hidden; }
        .header::before { content: '‚úù'; position: absolute; top: -30px; right: -30px; font-size: 150px; opacity: 0.05; color: var(--secondary); }
        .header-badge { display: inline-block; background: linear-gradient(135deg, var(--secondary) 0%, var(--accent) 100%); color: var(--dark); padding: 8px 20px; border-radius: 30px; font-size: 0.85rem; font-weight: 700; letter-spacing: 2px; text-transform: uppercase; margin-bottom: 15px; animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
        .header h1 { font-family: 'Playfair Display', serif; font-size: clamp(2rem, 6vw, 3rem); font-weight: 700; color: var(--light); margin-bottom: 10px; }
        .header h1 span { color: var(--secondary); }
        .header-subtitle { font-size: 1.1rem; color: rgba(255,255,255,0.8); margin-bottom: 20px; }
        .header-info { display: flex; justify-content: center; gap: 30px; flex-wrap: wrap; margin-top: 20px; }
        .header-info-item { display: flex; align-items: center; gap: 10px; background: rgba(255,255,255,0.1); padding: 12px 20px; border-radius: 10px; }
        .header-info-item .icon { font-size: 1.5rem; }
        .header-info-item .label { font-size: 0.75rem; text-transform: uppercase; letter-spacing: 1px; opacity: 0.7; }
        .header-info-item .value { font-weight: 600; }
        .form-card { background: rgba(255,255,255,0.05); backdrop-filter: blur(20px); border-radius: 20px; padding: 40px 30px; border: 1px solid rgba(255,255,255,0.1); box-shadow: 0 20px 60px rgba(0,0,0,0.3); margin-bottom: 30px; }
        .form-title { font-family: 'Playfair Display', serif; font-size: 1.8rem; text-align: center; margin-bottom: 30px; color: var(--secondary); }
        .form-group { margin-bottom: 25px; }
        .form-group label { display: block; font-weight: 600; margin-bottom: 8px; color: var(--light); font-size: 0.95rem; }
        .form-group label .required { color: var(--danger); }
        .form-group input, .form-group select { width: 100%; padding: 15px 18px; font-size: 1rem; font-family: 'Montserrat', sans-serif; border: 2px solid rgba(255,255,255,0.15); border-radius: 12px; background: rgba(255,255,255,0.08); color: var(--light); transition: all 0.3s ease; }
        .form-group input::placeholder { color: rgba(255,255,255,0.4); }
        .form-group input:focus, .form-group select:focus { outline: none; border-color: var(--secondary); background: rgba(255,255,255,0.12); box-shadow: 0 0 20px rgba(255, 215, 0, 0.2); }
        .form-group select { cursor: pointer; appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23FFD700' stroke-width='2'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 15px center; padding-right: 50px; }
        .form-group select option { background: var(--dark); color: var(--light); }
        .outro-wrapper { margin-top: 10px; display: none; }
        .outro-wrapper.show { display: block; }
        .input-hint { font-size: 0.8rem; color: rgba(255,255,255,0.5); margin-top: 5px; }
        .input-error { color: var(--danger); font-size: 0.85rem; margin-top: 5px; display: none; }
        .input-error.show { display: block; }
        .comissoes-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; }
        .comissao-item input[type="checkbox"] { display: none; }
        .comissao-label { display: flex; align-items: center; gap: 12px; padding: 15px 18px; background: rgba(255,255,255,0.05); border: 2px solid rgba(255,255,255,0.15); border-radius: 12px; cursor: pointer; transition: all 0.3s ease; }
        .comissao-label:hover { background: rgba(255,255,255,0.1); border-color: rgba(255,255,255,0.25); }
        .comissao-item input:checked + .comissao-label { background: rgba(139, 47, 135, 0.3); border-color: var(--primary); }
        .comissao-checkbox { width: 24px; height: 24px; border: 2px solid rgba(255,255,255,0.3); border-radius: 6px; display: flex; align-items: center; justify-content: center; transition: all 0.3s; flex-shrink: 0; }
        .comissao-item input:checked + .comissao-label .comissao-checkbox { background: var(--secondary); border-color: var(--secondary); }
        .comissao-checkbox::after { content: '‚úì'; color: var(--dark); font-weight: bold; opacity: 0; transform: scale(0); transition: all 0.2s; }
        .comissao-item input:checked + .comissao-label .comissao-checkbox::after { opacity: 1; transform: scale(1); }
        .comissao-icon { font-size: 1.5rem; }
        .comissao-name { font-weight: 600; margin-bottom: 2px; }
        .comissao-desc { font-size: 0.8rem; opacity: 0.6; }
        .btn-submit { width: 100%; padding: 18px 30px; font-size: 1.1rem; font-weight: 700; font-family: 'Montserrat', sans-serif; text-transform: uppercase; letter-spacing: 2px; border: none; border-radius: 12px; cursor: pointer; background: linear-gradient(135deg, var(--secondary) 0%, var(--accent) 100%); color: var(--dark); transition: all 0.3s ease; margin-top: 30px; }
        .btn-submit:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(255, 215, 0, 0.4); }
        .btn-submit:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
        .btn-submit .loading { display: none; }
        .btn-submit.loading .text { display: none; }
        .btn-submit.loading .loading { display: inline-block; }
        .toast { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%) translateY(100px); padding: 15px 30px; border-radius: 12px; font-weight: 600; z-index: 1000; opacity: 0; transition: all 0.4s ease; max-width: 90%; text-align: center; }
        .toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }
        .toast.success { background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%); color: white; }
        .toast.error { background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%); color: white; }
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); backdrop-filter: blur(5px); display: flex; align-items: center; justify-content: center; z-index: 1000; opacity: 0; visibility: hidden; transition: all 0.3s ease; overflow-y: auto; padding: 20px; }
        .modal-overlay.show { opacity: 1; visibility: visible; }
        .modal-content { background: linear-gradient(135deg, var(--dark) 0%, #16213e 100%); border-radius: 20px; padding: 50px 40px; max-width: 500px; width: 100%; text-align: center; border: 2px solid rgba(255,215,0,0.3); box-shadow: 0 30px 80px rgba(0,0,0,0.5); transform: scale(0.8); transition: all 0.3s ease; }
        .modal-overlay.show .modal-content { transform: scale(1); }
        .modal-icon { font-size: 5rem; margin-bottom: 20px; }
        .modal-title { font-family: 'Playfair Display', serif; font-size: 2rem; color: var(--secondary); margin-bottom: 15px; }
        .modal-text { color: rgba(255,255,255,0.8); line-height: 1.6; margin-bottom: 30px; }
        .modal-btn { padding: 15px 40px; font-size: 1rem; font-weight: 600; border: none; border-radius: 10px; cursor: pointer; background: var(--secondary); color: var(--dark); transition: all 0.3s; }
        .modal-btn:hover { transform: scale(1.05); }
        .admin-toggle { position: fixed; bottom: 20px; right: 20px; width: 50px; height: 50px; border-radius: 50%; background: var(--primary); border: none; color: white; font-size: 1.3rem; cursor: pointer; box-shadow: 0 5px 20px rgba(139, 47, 135, 0.5); transition: all 0.3s; z-index: 100; }
        .admin-toggle:hover { transform: scale(1.1); }
        .admin-panel { display: none; background: rgba(255,255,255,0.05); backdrop-filter: blur(20px); border-radius: 20px; padding: 30px; border: 1px solid rgba(255,255,255,0.1); margin-bottom: 30px; }
        .admin-panel.show { display: block; }
        .admin-title { font-family: 'Playfair Display', serif; font-size: 1.5rem; color: var(--secondary); margin-bottom: 20px; }
        .admin-section { margin-bottom: 30px; }
        .admin-section-title { font-size: 1.1rem; color: var(--secondary); margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .admin-stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: 12px; }
        .stat-card { background: rgba(255,255,255,0.08); border-radius: 12px; padding: 15px; text-align: center; }
        .stat-number { font-size: 2rem; font-weight: 700; color: var(--secondary); }
        .stat-label { font-size: 0.7rem; opacity: 0.7; margin-top: 5px; }
        .ministerio-stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; }
        .ministerio-stat { background: rgba(139, 47, 135, 0.2); border-radius: 10px; padding: 12px; display: flex; justify-content: space-between; align-items: center; }
        .ministerio-stat-name { font-size: 0.8rem; }
        .ministerio-stat-count { background: var(--secondary); color: var(--dark); font-weight: 700; padding: 4px 10px; border-radius: 20px; font-size: 0.85rem; }
        .inscricoes-lista { max-height: 400px; overflow-y: auto; }
        .inscricao-item { background: rgba(255,255,255,0.05); border-radius: 10px; padding: 15px; margin-bottom: 10px; border-left: 4px solid var(--primary); }
        .inscricao-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px; flex-wrap: wrap; gap: 10px; }
        .inscricao-nome { font-weight: 600; font-size: 1.1rem; }
        .inscricao-actions { display: flex; gap: 5px; }
        .inscricao-actions button { background: rgba(255,255,255,0.1); border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; font-size: 0.8rem; transition: all 0.2s; }
        .inscricao-actions .btn-edit { color: var(--secondary); }
        .inscricao-actions .btn-edit:hover { background: rgba(255, 215, 0, 0.2); }
        .inscricao-actions .btn-delete { color: var(--danger); }
        .inscricao-actions .btn-delete:hover { background: rgba(231, 76, 60, 0.2); }
        .inscricao-info { font-size: 0.85rem; opacity: 0.8; display: flex; flex-wrap: wrap; gap: 12px; }
        .inscricao-comissoes { margin-top: 8px; display: flex; flex-wrap: wrap; gap: 8px; }
        .inscricao-comissao-tag { background: rgba(139, 47, 135, 0.3); padding: 4px 10px; border-radius: 15px; font-size: 0.75rem; }
        .btn-export, .btn-whatsapp-all { border: none; padding: 12px 25px; border-radius: 10px; font-weight: 600; cursor: pointer; margin-top: 15px; transition: all 0.3s; }
        .btn-export { background: var(--success); color: white; }
        .btn-whatsapp-all { background: #25D366; color: white; margin-left: 10px; }
        .btn-export:hover, .btn-whatsapp-all:hover { transform: scale(1.05); }
        .modal-edit { max-width: 600px; }
        .modal-edit .form-group { text-align: left; margin-bottom: 20px; }
        .modal-edit-actions { display: flex; gap: 10px; justify-content: center; margin-top: 20px; }
        .modal-edit-actions button { padding: 12px 30px; border: none; border-radius: 10px; font-weight: 600; cursor: pointer; }
        .modal-edit-actions .btn-save { background: var(--success); color: white; }
        .modal-edit-actions .btn-cancel { background: rgba(255,255,255,0.1); color: var(--light); }
        .footer { text-align: center; padding: 30px; opacity: 0.6; font-size: 0.9rem; }
        .footer a { color: var(--secondary); text-decoration: none; }
        @media (max-width: 600px) { .container { padding: 15px; } .header { padding: 30px 15px; } .header-info { flex-direction: column; gap: 10px; } .form-card { padding: 25px 20px; } .comissoes-grid { grid-template-columns: 1fr; } .admin-stats { grid-template-columns: repeat(2, 1fr); } .ministerio-stats { grid-template-columns: 1fr; } .modal-content { padding: 30px 20px; } }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="header-badge">IDAC 2026</div>
            <h1>Encontro de <span>L√≠deres</span></h1>
            <p class="header-subtitle">Igreja de Deus √Åguas Claras</p>
            <div class="header-info">
                <div class="header-info-item">
                    <div class="icon">üìÖ</div>
                    <div class="text"><div class="label">Data</div><div class="value">24 de Janeiro</div></div>
                </div>
                <div class="header-info-item">
                    <div class="icon">‚è∞</div>
                    <div class="text"><div class="label">Hor√°rio</div><div class="value">8h √†s 18h</div></div>
                </div>
                <div class="header-info-item">
                    <div class="icon">üôè</div>
                    <div class="text"><div class="label">Dura√ß√£o</div><div class="value">10h de Comunh√£o!</div></div>
                </div>
            </div>
        </header>

        <div class="admin-panel" id="adminPanel">
            <h2 class="admin-title">üîê Painel Administrativo</h2>
            <div class="admin-section">
                <h3 class="admin-section-title">üìä Resumo por Comiss√£o</h3>
                <div class="admin-stats">
                    <div class="stat-card"><div class="stat-number" id="totalInscritos">0</div><div class="stat-label">Total</div></div>
                    <div class="stat-card"><div class="stat-number" id="totalCafe">0</div><div class="stat-label">‚òï Caf√©</div></div>
                    <div class="stat-card"><div class="stat-number" id="totalAlmoco">0</div><div class="stat-label">üçΩÔ∏è Almo√ßo</div></div>
                    <div class="stat-card"><div class="stat-number" id="totalLimpeza">0</div><div class="stat-label">üßπ Limpeza</div></div>
                    <div class="stat-card"><div class="stat-number" id="totalApoio">0</div><div class="stat-label">üìã Apoio</div></div>
                </div>
            </div>
            <div class="admin-section">
                <h3 class="admin-section-title">‚õ™ Inscritos por Minist√©rio</h3>
                <div class="ministerio-stats" id="ministerioStats"></div>
            </div>
            <div class="admin-section">
                <h3 class="admin-section-title">üìã Lista de Inscritos</h3>
                <div class="inscricoes-lista" id="inscricoesLista"></div>
            </div>
            <div>
                <button class="btn-export" onclick="exportarCSV()">üìä Exportar CSV</button>
                <button class="btn-whatsapp-all" onclick="copiarNumeros()">üì≤ Copiar N√∫meros</button>
            </div>
        </div>

        <div class="form-card">
            <h2 class="form-title">üìù Fa√ßa sua Inscri√ß√£o</h2>
            <form id="formInscricao" onsubmit="return false;">
                <div class="form-group">
                    <label>Nome Completo <span class="required">*</span></label>
                    <input type="text" id="nome" placeholder="Digite seu nome completo" required>
                </div>
                <div class="form-group">
                    <label>WhatsApp <span class="required">*</span></label>
                    <input type="tel" id="whatsapp" placeholder="(61) 99999-9999" maxlength="15" required>
                    <div class="input-hint">Digite o DDD (61 ou 62) + 9 d√≠gitos</div>
                    <div class="input-error" id="whatsappError">Formato inv√°lido. Use: (XX) 9XXXX-XXXX</div>
                </div>
                <div class="form-group">
                    <label>Minist√©rio que atua (ou atuar√°) <span class="required">*</span></label>
                    <select id="ministerio" required>
                        <option value="">-- Selecione o Minist√©rio --</option>
                        <option value="Mulheres">Mulheres</option>
                        <option value="Homens">Homens</option>
                        <option value="Infantil">Infantil</option>
                        <option value="Teens">Teens</option>
                        <option value="Melhor Idade">Melhor Idade</option>
                        <option value="A√ß√£o e Assist√™ncia Social">A√ß√£o e Assist√™ncia Social</option>
                        <option value="Louvor & Artes">Louvor & Artes</option>
                        <option value="Intercess√£o">Intercess√£o</option>
                        <option value="Ensino e EBD">Ensino e EBD</option>
                        <option value="Fam√≠lia">Fam√≠lia</option>
                        <option value="Miss√µes e Evangelismo">Miss√µes e Evangelismo</option>
                        <option value="Candeias no Lar">Candeias no Lar</option>
                        <option value="Conselho Fiscal">Conselho Fiscal</option>
                        <option value="Conselho Local">Conselho Local</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Fun√ß√£o <span class="required">*</span></label>
                    <select id="funcao" required onchange="toggleOutroFuncao()">
                        <option value="">-- Selecione a Fun√ß√£o --</option>
                        <option value="Pastor(a)">Pastor(a)</option>
                        <option value="Evangelista">Evangelista</option>
                        <option value="Presb√≠tero">Presb√≠tero</option>
                        <option value="Di√°cono(isa)">Di√°cono(isa)</option>
                        <option value="L√≠der">L√≠der</option>
                        <option value="Co-L√≠der">Co-L√≠der</option>
                        <option value="Outro">Outro (especificar)</option>
                    </select>
                    <div class="outro-wrapper" id="outroFuncaoWrapper">
                        <input type="text" id="outroFuncao" placeholder="Digite sua fun√ß√£o">
                    </div>
                </div>
                <div class="form-group">
                    <label>Comiss√£o(√µes) que deseja ajudar <span class="required">*</span></label>
                    <div class="comissoes-grid">
                        <div class="comissao-item">
                            <input type="checkbox" id="comissao_cafe" value="Caf√© da Manh√£">
                            <label class="comissao-label" for="comissao_cafe">
                                <div class="comissao-checkbox"></div>
                                <div class="comissao-icon">‚òï</div>
                                <div><div class="comissao-name">Caf√© da Manh√£</div><div class="comissao-desc">Preparo e organiza√ß√£o</div></div>
                            </label>
                        </div>
                        <div class="comissao-item">
                            <input type="checkbox" id="comissao_almoco" value="Almo√ßo">
                            <label class="comissao-label" for="comissao_almoco">
                                <div class="comissao-checkbox"></div>
                                <div class="comissao-icon">üçΩÔ∏è</div>
                                <div><div class="comissao-name">Almo√ßo</div><div class="comissao-desc">Preparo e servir</div></div>
                            </label>
                        </div>
                        <div class="comissao-item">
                            <input type="checkbox" id="comissao_limpeza" value="Limpeza">
                            <label class="comissao-label" for="comissao_limpeza">
                                <div class="comissao-checkbox"></div>
                                <div class="comissao-icon">üßπ</div>
                                <div><div class="comissao-name">Limpeza</div><div class="comissao-desc">Organiza√ß√£o do ambiente</div></div>
                            </label>
                        </div>
                        <div class="comissao-item">
                            <input type="checkbox" id="comissao_apoio" value="Apoio Administrativo">
                            <label class="comissao-label" for="comissao_apoio">
                                <div class="comissao-checkbox"></div>
                                <div class="comissao-icon">üìã</div>
                                <div><div class="comissao-name">Apoio Administrativo</div><div class="comissao-desc">Credenciamento e apoio</div></div>
                            </label>
                        </div>
                    </div>
                    <div class="input-error" id="comissaoError">Selecione pelo menos uma comiss√£o</div>
                </div>
                <button type="submit" class="btn-submit" id="btnSubmit" onclick="enviarInscricao()">
                    <span class="text">Confirmar Inscri√ß√£o</span>
                    <span class="loading">Enviando...</span>
                </button>
            </form>
        </div>
        <footer class="footer"><p>Igreja de Deus √Åguas Claras - IDAC</p><p>Encontro de L√≠deres 2026</p></footer>
    </div>

    <div class="toast" id="toast"></div>

    <div class="modal-overlay" id="modalSucesso">
        <div class="modal-content">
            <div class="modal-icon">üéâ</div>
            <h2 class="modal-title">Inscri√ß√£o Confirmada!</h2>
            <p class="modal-text">Sua inscri√ß√£o no <strong>Encontro de L√≠deres IDAC 2026</strong> foi realizada com sucesso!<br><br>Nos vemos no dia <strong>24 de janeiro</strong>, √†s <strong>8h</strong>!</p>
            <div style="background: linear-gradient(135deg, #FFD700 0%, #E8B923 100%); color: #1a1a2e; padding: 15px 20px; border-radius: 10px; margin: 20px 0; font-size: 0.9rem;">
                <strong>üöó PONTO DE ENCONTRO:</strong><br>
                <em>Estaremos nos reunindo no estacionamento da IDAC para irmos juntos, quem desejar, √†s <strong>7h da manh√£</strong></em>
            </div>
            <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                <button class="modal-btn" onclick="baixarComprovante()" style="background: #27ae60;">üì• Baixar Comprovante</button>
                <button class="modal-btn" onclick="fecharModal('modalSucesso')">Entendi!</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="modalEditar">
        <div class="modal-content modal-edit">
            <h2 class="modal-title">‚úèÔ∏è Editar Inscri√ß√£o</h2>
            <input type="hidden" id="editId">
            <div class="form-group"><label>Nome</label><input type="text" id="editNome"></div>
            <div class="form-group"><label>WhatsApp</label><input type="tel" id="editWhatsapp" maxlength="15"></div>
            <div class="form-group"><label>Minist√©rio</label>
                <select id="editMinisterio">
                    <option value="">-- Selecione --</option>
                    <option value="Mulheres">Mulheres</option>
                    <option value="Homens">Homens</option>
                    <option value="Infantil">Infantil</option>
                    <option value="Teens">Teens</option>
                    <option value="Melhor Idade">Melhor Idade</option>
                    <option value="A√ß√£o e Assist√™ncia Social">A√ß√£o e Assist√™ncia Social</option>
                    <option value="Louvor & Artes">Louvor & Artes</option>
                    <option value="Intercess√£o">Intercess√£o</option>
                    <option value="Ensino e EBD">Ensino e EBD</option>
                    <option value="Fam√≠lia">Fam√≠lia</option>
                    <option value="Miss√µes e Evangelismo">Miss√µes e Evangelismo</option>
                    <option value="Candeias no Lar">Candeias no Lar</option>
                    <option value="Conselho Fiscal">Conselho Fiscal</option>
                    <option value="Conselho Local">Conselho Local</option>
                </select>
            </div>
            <div class="form-group"><label>Fun√ß√£o</label><input type="text" id="editFuncao"></div>
            <div class="modal-edit-actions">
                <button class="btn-cancel" onclick="fecharModal('modalEditar')">Cancelar</button>
                <button class="btn-save" onclick="salvarEdicao()">üíæ Salvar</button>
            </div>
        </div>
    </div>

    <button class="admin-toggle" onclick="toggleAdmin()" title="Painel Admin">üîê</button>

    <script>
        const firebaseConfig = { apiKey: "AIzaSyD_FbMpEZYn_lLZiSjGmP0sMM7XcuTn8Qw", authDomain: "games-idac.firebaseapp.com", databaseURL: "https://games-idac-default-rtdb.firebaseio.com", projectId: "games-idac", storageBucket: "games-idac.appspot.com" };
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const inscricoesRef = database.ref('encontro_lideres_2026/inscricoes');

        let isAdmin = false;
        let inscricoes = [];
        let ultimaInscricao = null; // Guardar dados da √∫ltima inscri√ß√£o
        const ministerios = ['Mulheres', 'Homens', 'Infantil', 'Teens', 'Melhor Idade', 'A√ß√£o e Assist√™ncia Social', 'Louvor & Artes', 'Intercess√£o', 'Ensino e EBD', 'Fam√≠lia', 'Miss√µes e Evangelismo', 'Candeias no Lar', 'Conselho Fiscal', 'Conselho Local'];

        function init() { carregarInscricoes(); setupMascaraTelefone(); }

        function setupMascaraTelefone() {
            document.querySelectorAll('input[type="tel"]').forEach(input => {
                input.addEventListener('input', function(e) {
                    let v = e.target.value.replace(/\D/g, '');
                    if (v.length > 11) v = v.slice(0, 11);
                    if (v.length > 0) {
                        if (v.length <= 2) v = '(' + v;
                        else if (v.length <= 7) v = '(' + v.slice(0, 2) + ') ' + v.slice(2);
                        else v = '(' + v.slice(0, 2) + ') ' + v.slice(2, 7) + '-' + v.slice(7);
                    }
                    e.target.value = v;
                    if (e.target.id === 'whatsapp') validarTelefone();
                });
            });
        }

        function validarTelefone() {
            const input = document.getElementById('whatsapp'), error = document.getElementById('whatsappError'), v = input.value.replace(/\D/g, '');
            const ddds = ['61','62','63','64','65','66','67','68','69','11','12','13','14','15','16','17','18','19','21','22','24','27','28','31','32','33','34','35','37','38','41','42','43','44','45','46','47','48','49','51','53','54','55','71','73','74','75','77','79','81','82','83','84','85','86','87','88','89','91','92','93','94','95','96','97','98','99'];
            if (v.length === 11 && ddds.includes(v.slice(0, 2)) && v[2] === '9') { error.classList.remove('show'); input.style.borderColor = 'var(--success)'; return true; }
            else if (v.length > 0) { error.classList.add('show'); input.style.borderColor = 'var(--danger)'; return false; }
            input.style.borderColor = ''; error.classList.remove('show'); return false;
        }

        function toggleOutroFuncao() {
            const sel = document.getElementById('funcao'), wrap = document.getElementById('outroFuncaoWrapper'), inp = document.getElementById('outroFuncao');
            if (sel.value === 'Outro') { wrap.classList.add('show'); inp.required = true; } else { wrap.classList.remove('show'); inp.required = false; inp.value = ''; }
        }

        function carregarInscricoes() {
            inscricoesRef.on('value', snap => {
                const d = snap.val() || {};
                inscricoes = Object.entries(d).map(([id, data]) => ({ id, ...data }));
                if (isAdmin) atualizarPainelAdmin();
            });
        }

        function enviarInscricao() {
            const nome = document.getElementById('nome').value.trim(), whatsapp = document.getElementById('whatsapp').value.replace(/\D/g, ''), ministerio = document.getElementById('ministerio').value;
            let funcao = document.getElementById('funcao').value;
            if (funcao === 'Outro') { funcao = document.getElementById('outroFuncao').value.trim(); if (!funcao) { showToast('Especifique sua fun√ß√£o!', 'error'); return; } }
            const comissoes = [];
            if (document.getElementById('comissao_cafe').checked) comissoes.push('Caf√© da Manh√£');
            if (document.getElementById('comissao_almoco').checked) comissoes.push('Almo√ßo');
            if (document.getElementById('comissao_limpeza').checked) comissoes.push('Limpeza');
            if (document.getElementById('comissao_apoio').checked) comissoes.push('Apoio Administrativo');
            if (!nome) { showToast('Digite seu nome!', 'error'); return; }
            if (!validarTelefone()) { showToast('WhatsApp inv√°lido!', 'error'); return; }
            if (!ministerio) { showToast('Selecione um minist√©rio!', 'error'); return; }
            if (!funcao) { showToast('Selecione uma fun√ß√£o!', 'error'); return; }
            if (comissoes.length === 0) { document.getElementById('comissaoError').classList.add('show'); showToast('Selecione pelo menos uma comiss√£o!', 'error'); return; }
            document.getElementById('comissaoError').classList.remove('show');
            const btn = document.getElementById('btnSubmit'); btn.classList.add('loading'); btn.disabled = true;
            
            // Guardar dados para o comprovante
            ultimaInscricao = { nome, whatsapp, ministerio, funcao, comissoes };
            
            inscricoesRef.push({ nome, whatsapp, ministerio, funcao, comissoes, dataInscricao: new Date().toISOString() })
                .then(() => { btn.classList.remove('loading'); btn.disabled = false; document.getElementById('formInscricao').reset(); document.getElementById('whatsapp').style.borderColor = ''; document.getElementById('outroFuncaoWrapper').classList.remove('show'); document.getElementById('modalSucesso').classList.add('show'); })
                .catch(err => { btn.classList.remove('loading'); btn.disabled = false; showToast('Erro: ' + err.message, 'error'); });
        }

        function toggleAdmin() {
            if (!isAdmin) { const s = prompt('Senha:'); if (s === 'idac2026') { isAdmin = true; document.getElementById('adminPanel').classList.add('show'); atualizarPainelAdmin(); showToast('Admin ativado!', 'success'); } else if (s !== null) showToast('Senha incorreta!', 'error'); }
            else { isAdmin = false; document.getElementById('adminPanel').classList.remove('show'); }
        }

        function atualizarPainelAdmin() {
            document.getElementById('totalInscritos').textContent = inscricoes.length;
            document.getElementById('totalCafe').textContent = inscricoes.filter(i => i.comissoes?.includes('Caf√© da Manh√£')).length;
            document.getElementById('totalAlmoco').textContent = inscricoes.filter(i => i.comissoes?.includes('Almo√ßo')).length;
            document.getElementById('totalLimpeza').textContent = inscricoes.filter(i => i.comissoes?.includes('Limpeza')).length;
            document.getElementById('totalApoio').textContent = inscricoes.filter(i => i.comissoes?.includes('Apoio Administrativo')).length;
            const mc = document.getElementById('ministerioStats'), cont = {};
            ministerios.forEach(m => cont[m] = 0);
            inscricoes.forEach(i => { if (i.ministerio && cont[i.ministerio] !== undefined) cont[i.ministerio]++; });
            mc.innerHTML = Object.entries(cont).sort((a, b) => b[1] - a[1]).map(([n, c]) => '<div class="ministerio-stat"><span class="ministerio-stat-name">' + n + '</span><span class="ministerio-stat-count">' + c + '</span></div>').join('');
            const lc = document.getElementById('inscricoesLista');
            if (inscricoes.length === 0) { lc.innerHTML = '<p style="text-align:center;opacity:0.6">Nenhuma inscri√ß√£o.</p>'; return; }
            lc.innerHTML = [...inscricoes].sort((a, b) => a.nome.localeCompare(b.nome)).map(i => '<div class="inscricao-item"><div class="inscricao-header"><div class="inscricao-nome">' + i.nome + '</div><div class="inscricao-actions"><button class="btn-edit" onclick="editarInscricao(\'' + i.id + '\')">‚úèÔ∏è</button><button class="btn-delete" onclick="excluirInscricao(\'' + i.id + '\',\'' + i.nome.replace(/'/g, "\\'") + '\')">üóëÔ∏è</button></div></div><div class="inscricao-info"><span>üì± ' + formatarTel(i.whatsapp) + '</span><span>‚õ™ ' + (i.ministerio || '-') + '</span><span>üëî ' + (i.funcao || '-') + '</span></div><div class="inscricao-comissoes">' + (i.comissoes || []).map(c => '<span class="inscricao-comissao-tag">' + c + '</span>').join('') + '</div></div>').join('');
        }

        function formatarTel(t) { return t && t.length === 11 ? '(' + t.slice(0, 2) + ') ' + t.slice(2, 7) + '-' + t.slice(7) : t || ''; }

        function editarInscricao(id) {
            const i = inscricoes.find(x => x.id === id); if (!i) return;
            document.getElementById('editId').value = id;
            document.getElementById('editNome').value = i.nome || '';
            document.getElementById('editWhatsapp').value = formatarTel(i.whatsapp);
            document.getElementById('editMinisterio').value = i.ministerio || '';
            document.getElementById('editFuncao').value = i.funcao || '';
            document.getElementById('modalEditar').classList.add('show');
        }

        function salvarEdicao() {
            const id = document.getElementById('editId').value;
            inscricoesRef.child(id).update({ nome: document.getElementById('editNome').value.trim(), whatsapp: document.getElementById('editWhatsapp').value.replace(/\D/g, ''), ministerio: document.getElementById('editMinisterio').value, funcao: document.getElementById('editFuncao').value.trim() })
                .then(() => { fecharModal('modalEditar'); showToast('Atualizado!', 'success'); })
                .catch(e => showToast('Erro: ' + e.message, 'error'));
        }

        function excluirInscricao(id, nome) { if (confirm('Excluir ' + nome + '?')) inscricoesRef.child(id).remove().then(() => showToast('Exclu√≠do!', 'success')); }

        function exportarCSV() {
            if (!inscricoes.length) { showToast('Nenhuma inscri√ß√£o!', 'error'); return; }
            let csv = 'Nome,WhatsApp,Minist√©rio,Fun√ß√£o,Comiss√µes,Data\n';
            inscricoes.forEach(i => csv += '"' + i.nome + '","' + formatarTel(i.whatsapp) + '","' + (i.ministerio||'') + '","' + (i.funcao||'') + '","' + (i.comissoes||[]).join('; ') + '","' + new Date(i.dataInscricao).toLocaleDateString('pt-BR') + '"\n');
            const b = new Blob([csv], { type: 'text/csv;charset=utf-8;' }), l = document.createElement('a'); l.href = URL.createObjectURL(b); l.download = 'inscricoes_lideres_2026.csv'; l.click();
        }

        function copiarNumeros() { if (!inscricoes.length) { showToast('Nenhuma inscri√ß√£o!', 'error'); return; } navigator.clipboard.writeText(inscricoes.map(i => '55' + i.whatsapp).join('\n')).then(() => showToast(inscricoes.length + ' n√∫meros copiados!', 'success')); }

        function showToast(m, t = 'success') { const toast = document.getElementById('toast'); toast.textContent = m; toast.className = 'toast ' + t + ' show'; setTimeout(() => toast.classList.remove('show'), 3000); }
        function fecharModal(id) { document.getElementById(id).classList.remove('show'); }
        document.querySelectorAll('.modal-overlay').forEach(m => m.addEventListener('click', e => { if (e.target === m) m.classList.remove('show'); }));
        function baixarComprovante() {
            if (!ultimaInscricao) { showToast('Dados n√£o encontrados!', 'error'); return; }
            
            const canvas = document.createElement('canvas');
            canvas.width = 800;
            canvas.height = 1000;
            const ctx = canvas.getContext('2d');
            
            // Fundo gradiente
            const grad = ctx.createLinearGradient(0, 0, 800, 1000);
            grad.addColorStop(0, '#1a1a2e');
            grad.addColorStop(0.5, '#16213e');
            grad.addColorStop(1, '#0f3460');
            ctx.fillStyle = grad;
            ctx.fillRect(0, 0, 800, 1000);
            
            // C√≠rculos decorativos
            ctx.fillStyle = 'rgba(139, 47, 135, 0.15)';
            ctx.beginPath();
            ctx.arc(100, 800, 200, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = 'rgba(255, 215, 0, 0.1)';
            ctx.beginPath();
            ctx.arc(700, 200, 150, 0, Math.PI * 2);
            ctx.fill();
            
            // Badge IDAC 2026
            ctx.fillStyle = '#FFD700';
            roundRect(ctx, 300, 50, 200, 40, 20);
            ctx.fill();
            ctx.fillStyle = '#1a1a2e';
            ctx.font = 'bold 16px Montserrat, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('IDAC 2026', 400, 77);
            
            // Emoji celebra√ß√£o
            ctx.font = '80px Arial';
            ctx.fillText('üéâ', 400, 180);
            
            // T√≠tulo
            ctx.fillStyle = '#FFD700';
            ctx.font = 'bold 42px Georgia, serif';
            ctx.fillText('Inscri√ß√£o Confirmada!', 400, 260);
            
            // Subt√≠tulo
            ctx.fillStyle = 'rgba(255,255,255,0.8)';
            ctx.font = '20px Montserrat, sans-serif';
            ctx.fillText('Encontro de L√≠deres IDAC 2026', 400, 300);
            
            // Card com dados
            ctx.fillStyle = 'rgba(255,255,255,0.08)';
            roundRect(ctx, 50, 340, 700, 320, 20);
            ctx.fill();
            ctx.strokeStyle = 'rgba(255,255,255,0.15)';
            ctx.lineWidth = 2;
            roundRect(ctx, 50, 340, 700, 320, 20);
            ctx.stroke();
            
            // Dados do inscrito
            ctx.textAlign = 'left';
            ctx.fillStyle = 'rgba(255,255,255,0.6)';
            ctx.font = '14px Montserrat, sans-serif';
            ctx.fillText('NOME', 90, 390);
            ctx.fillStyle = '#ffffff';
            ctx.font = 'bold 24px Montserrat, sans-serif';
            ctx.fillText(ultimaInscricao.nome, 90, 420);
            
            ctx.fillStyle = 'rgba(255,255,255,0.6)';
            ctx.font = '14px Montserrat, sans-serif';
            ctx.fillText('MINIST√âRIO', 90, 470);
            ctx.fillStyle = '#FFD700';
            ctx.font = 'bold 20px Montserrat, sans-serif';
            ctx.fillText(ultimaInscricao.ministerio, 90, 500);
            
            ctx.fillStyle = 'rgba(255,255,255,0.6)';
            ctx.font = '14px Montserrat, sans-serif';
            ctx.fillText('FUN√á√ÉO', 450, 470);
            ctx.fillStyle = '#FFD700';
            ctx.font = 'bold 20px Montserrat, sans-serif';
            ctx.fillText(ultimaInscricao.funcao, 450, 500);
            
            ctx.fillStyle = 'rgba(255,255,255,0.6)';
            ctx.font = '14px Montserrat, sans-serif';
            ctx.fillText('COMISS√ÉO(√ïES)', 90, 550);
            ctx.fillStyle = '#ffffff';
            ctx.font = '18px Montserrat, sans-serif';
            ctx.fillText(ultimaInscricao.comissoes.join(' ‚Ä¢ '), 90, 580);
            
            // Data e hor√°rio
            ctx.fillStyle = 'rgba(255,255,255,0.6)';
            ctx.font = '14px Montserrat, sans-serif';
            ctx.fillText('DATA E HOR√ÅRIO', 90, 620);
            ctx.fillStyle = '#ffffff';
            ctx.font = 'bold 20px Montserrat, sans-serif';
            ctx.fillText('24 de Janeiro de 2026 ‚Ä¢ 8h √†s 18h', 90, 650);
            
            // Card ponto de encontro (destaque)
            const gradYellow = ctx.createLinearGradient(50, 700, 750, 700);
            gradYellow.addColorStop(0, '#FFD700');
            gradYellow.addColorStop(1, '#E8B923');
            ctx.fillStyle = gradYellow;
            roundRect(ctx, 50, 700, 700, 100, 15);
            ctx.fill();
            
            ctx.fillStyle = '#1a1a2e';
            ctx.font = 'bold 18px Montserrat, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('üöó PONTO DE ENCONTRO', 400, 740);
            ctx.font = 'italic 16px Montserrat, sans-serif';
            ctx.fillText('Estacionamento da IDAC √†s 7h da manh√£', 400, 770);
            ctx.fillText('para irmos juntos!', 400, 790);
            
            // Rodap√©
            ctx.fillStyle = 'rgba(255,255,255,0.5)';
            ctx.font = '14px Montserrat, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('Igreja de Deus √Åguas Claras - IDAC', 400, 880);
            ctx.fillText('10 horas de muita comunh√£o! üôè', 400, 905);
            
            // Cruz decorativa
            ctx.fillStyle = 'rgba(255,215,0,0.1)';
            ctx.font = '120px Arial';
            ctx.fillText('‚úù', 700, 950);
            
            // Baixar
            const link = document.createElement('a');
            link.download = 'comprovante_encontro_lideres_' + ultimaInscricao.nome.split(' ')[0].toLowerCase() + '.png';
            link.href = canvas.toDataURL('image/png');
            link.click();
            
            showToast('Comprovante baixado!', 'success');
        }
        
        function roundRect(ctx, x, y, w, h, r) {
            ctx.beginPath();
            ctx.moveTo(x + r, y);
            ctx.lineTo(x + w - r, y);
            ctx.quadraticCurveTo(x + w, y, x + w, y + r);
            ctx.lineTo(x + w, y + h - r);
            ctx.quadraticCurveTo(x + w, y + h, x + w - r, y + h);
            ctx.lineTo(x + r, y + h);
            ctx.quadraticCurveTo(x, y + h, x, y + h - r);
            ctx.lineTo(x, y + r);
            ctx.quadraticCurveTo(x, y, x + r, y);
            ctx.closePath();
        }

        init();
    </script>
</body>
</html>
